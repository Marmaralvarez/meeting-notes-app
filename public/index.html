<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meeting Notes AI Assistant</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f8faf6;
            color: #1f2937;
            line-height: 1.6;
        }
        
        .custom-file-input {
            position: relative;
            overflow: hidden;
            display: inline-block;
            cursor: pointer;
        }
        
        .custom-file-input input[type=file] {
            position: absolute;
            left: -9999px;
        }
        
        .markdown-content h1 { font-size: 1.875rem; font-weight: 700; margin: 1.5rem 0 1rem 0; color: #1f2937; }
        .markdown-content h2 { font-size: 1.5rem; font-weight: 600; margin: 1.25rem 0 0.75rem 0; color: #374151; }
        .markdown-content h3 { font-size: 1.25rem; font-weight: 600; margin: 1rem 0 0.5rem 0; color: #4b5563; }
        .markdown-content h4 { font-size: 1.125rem; font-weight: 600; margin: 0.75rem 0 0.5rem 0; color: #6b7280; }
        .markdown-content p { margin: 0.5rem 0; }
        .markdown-content ul, .markdown-content ol { margin: 0.5rem 0; padding-left: 1.5rem; }
        .markdown-content li { margin: 0.25rem 0; }
        .markdown-content strong { font-weight: 600; color: #1f2937; }
        .markdown-content table { width: 100%; border-collapse: collapse; margin: 1rem 0; }
        .markdown-content th, .markdown-content td { border: 1px solid #d1d5db; padding: 0.5rem; text-align: left; }
        .markdown-content th { background-color: #f3f4f6; font-weight: 600; }
        .markdown-content blockquote { border-left: 4px solid #d1d5db; padding-left: 1rem; margin: 1rem 0; font-style: italic; color: #6b7280; }
        .markdown-content code { background-color: #f3f4f6; padding: 0.125rem 0.25rem; border-radius: 0.25rem; font-family: 'Courier New', monospace; font-size: 0.875rem; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        // Simple markdown-like renderer
        const renderText = (text) => {
            if (!text) return '';
            
            return text
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/^# (.*$)/gim, '<h1>$1</h1>')
                .replace(/^## (.*$)/gim, '<h2>$1</h2>')
                .replace(/^### (.*$)/gim, '<h3>$1</h3>')
                .replace(/^#### (.*$)/gim, '<h4>$1</h4>')
                .replace(/^\- (.*$)/gim, '<li>$1</li>')
                .replace(/(<li>.*<\/li>)/gs, '<ul>$1</ul>')
                .replace(/^\| (.*$)/gim, '<tr><td>$1</td></tr>')
                .replace(/(<tr>.*<\/tr>)/gs, '<table>$1</table>')
                .replace(/\n/g, '<br>');
        };

        function MeetingNotesApp() {
            // State management
            const [files, setFiles] = useState([]);
            const [rawNotes, setRawNotes] = useState('');
            const [summary, setSummary] = useState('');
            const [isGenerating, setIsGenerating] = useState(false);
            const [meetingDate, setMeetingDate] = useState('');
            const [meetingTime, setMeetingTime] = useState('');
            const [location, setLocation] = useState('');
            const [meetingTitle, setMeetingTitle] = useState('');
            const [companyAttendees, setCompanyAttendees] = useState('');
            const [clientAttendees, setClientAttendees] = useState('');

            // Brain functionality
            const [storedMeetings, setStoredMeetings] = useState([]);
            const [showBrain, setShowBrain] = useState(false);
            const [brainQuery, setBrainQuery] = useState('');
            const [brainResponse, setBrainResponse] = useState('');
            const [isBrainLoading, setIsBrainLoading] = useState(false);
            const [showSaveSuccess, setShowSaveSuccess] = useState(false);
            const [isLoadingMeetings, setIsLoadingMeetings] = useState(false);
            const [saveError, setSaveError] = useState('');

            // Your Vercel API endpoint
            const API_BASE_URL = 'https://meeting-notes-api-watertrace.vercel.app/api';

            // Load meetings from database on component mount
            useEffect(() => {
                loadMeetingsFromDatabase();
            }, []);

            const loadMeetingsFromDatabase = async () => {
                setIsLoadingMeetings(true);
                try {
                    console.log('Loading meetings from API...');
                    const response = await fetch(`${API_BASE_URL}/meetings`, {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });

                    if (response.ok) {
                        const meetings = await response.json();
                        console.log('Loaded meetings:', meetings);
                        
                        const appFormatMeetings = meetings.map(meeting => ({
                            id: meeting.id,
                            date: meeting.meeting_date,
                            time: meeting.meeting_time,
                            venue: meeting.venue,
                            title: meeting.title,
                            companyAttendees: meeting.company_attendees,
                            clientAttendees: meeting.client_attendees,
                            rawNotes: meeting.raw_notes,
                            summary: meeting.summary,
                            createdAt: meeting.created_at
                        }));
                        
                        setStoredMeetings(appFormatMeetings);
                    }
                } catch (error) {
                    console.error('Error loading meetings:', error);
                } finally {
                    setIsLoadingMeetings(false);
                }
            };

            const saveMeetingToDatabase = async (meetingRecord) => {
                try {
                    const response = await fetch(`${API_BASE_URL}/meetings`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            id: meetingRecord.id,
                            title: meetingRecord.title,
                            meeting_date: meetingRecord.date,
                            meeting_time: meetingRecord.time,
                            venue: meetingRecord.venue,
                            company_attendees: meetingRecord.companyAttendees,
                            client_attendees: meetingRecord.clientAttendees,
                            raw_notes: meetingRecord.rawNotes,
                            summary: meetingRecord.summary,
                            created_at: meetingRecord.createdAt
                        })
                    });

                    if (response.ok) {
                        const savedMeeting = await response.json();
                        return savedMeeting;
                    } else {
                        throw new Error(`HTTP ${response.status}`);
                    }
                } catch (error) {
                    console.error('Error saving meeting:', error);
                    throw error;
                }
            };

            const deleteMeetingFromDatabase = async (id) => {
                try {
                    const response = await fetch(`${API_BASE_URL}/meetings?id=${id}`, {
                        method: 'DELETE',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}`);
                    }
                } catch (error) {
                    console.error('Error deleting meeting:', error);
                    throw error;
                }
            };

            const handleFileUpload = (event) => {
                const uploadedFiles = Array.from(event.target.files);
                setFiles(prev => [...prev, ...uploadedFiles]);
            };

            const removeFile = (index) => {
                setFiles(prev => prev.filter((_, i) => i !== index));
            };

            const extractFromFiles = async () => {
                if (files.length === 0) return;
                setIsGenerating(true);
                
                try {
                    let extractedContent = '';
                    for (const file of files) {
                        const text = await readFile(file);
                        extractedContent += text + '\n\n';
                    }
                    
                    setRawNotes(extractedContent);
                    
                    // Extract meeting details with better regex patterns
                    const patterns = {
                        date: /(?:date|meeting date|on)[:\s]+(\d{4}-\d{2}-\d{2}|\d{1,2}[\/\-]\d{1,2}[\/\-]\d{4})/i,
                        time: /(?:time|meeting time|at)[:\s]+(\d{1,2}:\d{2}(?:\s*[AP]M)?)/i,
                        location: /(?:location|venue|place|room|address)[:\s]+([^\n\r]+)/i,
                        title: /(?:title|subject|meeting|topic)[:\s]+([^\n\r]+)/i
                    };
                    
                    const dateMatch = extractedContent.match(patterns.date);
                    const timeMatch = extractedContent.match(patterns.time);
                    const locationMatch = extractedContent.match(patterns.location);
                    const titleMatch = extractedContent.match(patterns.title);
                    
                    if (dateMatch) {
                        let dateStr = dateMatch[1];
                        // Convert various date formats to YYYY-MM-DD
                        if (dateStr.includes('/') || dateStr.includes('-')) {
                            const date = new Date(dateStr);
                            if (!isNaN(date.getTime())) {
                                setMeetingDate(date.toISOString().split('T')[0]);
                            }
                        } else {
                            setMeetingDate(dateStr);
                        }
                    }
                    if (timeMatch) setMeetingTime(timeMatch[1].replace(/\s*(AM|PM)/i, ''));
                    if (locationMatch) setLocation(locationMatch[1].trim());
                    if (titleMatch) setMeetingTitle(titleMatch[1].trim());
                    
                } catch (error) {
                    console.error('Error extracting from files:', error);
                } finally {
                    setIsGenerating(false);
                }
            };

            const readFile = (file) => {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = (e) => resolve(e.target.result);
                    reader.onerror = reject;
                    reader.readAsText(file);
                });
            };

            const generateSummary = async () => {
                if (!rawNotes.trim()) return;
                setIsGenerating(true);
                
                try {
                    // Enhanced template summary with more British professional language
                    const summary = `# Meeting Summary: ${meetingTitle || 'Strategic Discussion'}

## Meeting Overview

This meeting focused on key strategic initiatives and operational requirements. The discussion covered multiple workstreams and established clear action items for all stakeholders involved.

## Key Decisions Made

- Confirmed project timelines and deliverable expectations
- Established clear communication protocols between teams
- Agreed on resource allocation and responsibility matrix
- Validated technical requirements and implementation approach

## Action Items

| Assignee | Task Description | Due Date | Priority | Status |
|----------|------------------|----------|----------|--------|
| Team Lead | Finalise project specification document | TBD | High | Not Started |
| Technical Lead | Complete technical feasibility assessment | TBD | High | Not Started |
| Project Manager | Schedule follow-up stakeholder meetings | TBD | Medium | Not Started |
| All Attendees | Review and provide feedback on proposals | TBD | Medium | Not Started |

## Discussion Points & Insights

**Strategic Considerations:**
- Market positioning and competitive landscape analysis
- Resource optimisation and operational efficiency improvements
- Risk mitigation strategies and contingency planning
- Timeline considerations and milestone achievement

**Technical Requirements:**
- System integration and compatibility requirements
- Performance benchmarks and success criteria
- Security protocols and compliance considerations
- Scalability planning for future growth

## Financial & Resource Implications

- Budget allocation requires further review and approval
- Resource planning to be finalised pending stakeholder confirmation
- Cost-benefit analysis demonstrates positive ROI projections
- Investment timeline aligns with organisational strategic priorities

## Next Steps & Follow-up

- Detailed project roadmap to be developed and circulated
- Stakeholder feedback sessions to be scheduled within two weeks
- Technical documentation to be prepared and reviewed
- Implementation timeline to be confirmed following approval processes

## Outstanding Issues

- Final budget approval pending executive review
- Technical specifications require additional stakeholder input
- Resource availability needs confirmation from department heads
- Regulatory compliance considerations require legal review

The meeting concluded with clear ownership of deliverables and established communication channels for ongoing project coordination. All participants expressed commitment to achieving the agreed-upon objectives within the specified timeframes.`;

                    setSummary(summary);
                } catch (error) {
                    console.error('Error generating summary:', error);
                } finally {
                    setIsGenerating(false);
                }
            };

            const saveToBrain = async () => {
                if (!summary.trim()) return;
                
                setSaveError('');
                const meetingRecord = {
                    id: Date.now(),
                    date: meetingDate || new Date().toISOString().split('T')[0],
                    time: meetingTime || '',
                    venue: location || '',
                    title: meetingTitle || 'Untitled Meeting',
                    companyAttendees: companyAttendees || '',
                    clientAttendees: clientAttendees || '',
                    rawNotes: rawNotes,
                    summary: summary,
                    createdAt: new Date().toISOString()
                };
                
                try {
                    const savedMeeting = await saveMeetingToDatabase(meetingRecord);
                    const appFormatMeeting = {
                        id: savedMeeting.id,
                        date: savedMeeting.meeting_date,
                        time: savedMeeting.meeting_time,
                        venue: savedMeeting.venue,
                        title: savedMeeting.title,
                        companyAttendees: savedMeeting.company_attendees,
                        clientAttendees: savedMeeting.client_attendees,
                        rawNotes: savedMeeting.raw_notes,
                        summary: savedMeeting.summary,
                        createdAt: savedMeeting.created_at
                    };
                    
                    setStoredMeetings(prev => [appFormatMeeting, ...prev]);
                    setShowSaveSuccess(true);
                    setTimeout(() => setShowSaveSuccess(false), 3000);
                } catch (error) {
                    setSaveError('Failed to save meeting to database. Please try again.');
                    setTimeout(() => setSaveError(''), 5000);
                }
            };

            const deleteMeeting = async (id) => {
                try {
                    await deleteMeetingFromDatabase(id);
                    setStoredMeetings(prev => prev.filter(meeting => meeting.id !== id));
                } catch (error) {
                    setSaveError('Failed to delete meeting. Please try again.');
                    setTimeout(() => setSaveError(''), 5000);
                }
            };

            const handleBrainQuery = async () => {
                if (!brainQuery.trim() || storedMeetings.length === 0) return;

                setIsBrainLoading(true);
                setBrainResponse('');

                try {
                    // Get fresh data from database
                    const response = await fetch(`${API_BASE_URL}/meetings`);
                    let meetingsForQuery = storedMeetings;
                    
                    if (response.ok) {
                        const latestMeetings = await response.json();
                        meetingsForQuery = latestMeetings.map(meeting => ({
                            id: meeting.id,
                            date: meeting.meeting_date,
                            time: meeting.meeting_time,
                            venue: meeting.venue,
                            title: meeting.title,
                            companyAttendees: meeting.company_attendees,
                            clientAttendees: meeting.client_attendees,
                            rawNotes: meeting.raw_notes,
                            summary: meeting.summary,
                            createdAt: meeting.created_at
                        }));
                    }

                    // Enhanced placeholder response with more intelligent analysis
                    const queryLower = brainQuery.toLowerCase();
                    let response_text = '';

                    if (queryLower.includes('action') || queryLower.includes('task')) {
                        response_text = `Based on ${meetingsForQuery.length} stored meetings, here are the action items I found:\n\n`;
                        meetingsForQuery.forEach(meeting => {
                            if (meeting.summary.toLowerCase().includes('action')) {
                                response_text += `**${meeting.title}** (${meeting.date}):\n`;
                                response_text += `- Action items mentioned in summary\n`;
                                response_text += `- Review meeting details for specific assignments\n\n`;
                            }
                        });
                    } else if (queryLower.includes('who') || queryLower.includes('attendees')) {
                        response_text = `Meeting attendees across ${meetingsForQuery.length} meetings:\n\n`;
                        meetingsForQuery.forEach(meeting => {
                            response_text += `**${meeting.title}** (${meeting.date}):\n`;
                            if (meeting.companyAttendees) response_text += `- Company: ${meeting.companyAttendees}\n`;
                            if (meeting.clientAttendees) response_text += `- Client: ${meeting.clientAttendees}\n`;
                            response_text += '\n';
                        });
                    } else if (queryLower.includes('when') || queryLower.includes('date')) {
                        response_text = `Meeting timeline from ${meetingsForQuery.length} stored meetings:\n\n`;
                        meetingsForQuery.sort((a, b) => new Date(a.date) - new Date(b.date)).forEach(meeting => {
                            response_text += `- **${meeting.title}**: ${meeting.date}${meeting.time ? ` at ${meeting.time}` : ''}\n`;
                        });
                    } else {
                        response_text = `I found ${meetingsForQuery.length} meetings in the database. Here's a summary:\n\n`;
                        meetingsForQuery.slice(0, 3).forEach(meeting => {
                            response_text += `**${meeting.title}** (${meeting.date}):\n`;
                            response_text += `${meeting.summary.substring(0, 200)}...\n\n`;
                        });
                        if (meetingsForQuery.length > 3) {
                            response_text += `And ${meetingsForQuery.length - 3} more meetings available.`;
                        }
                    }

                    response_text += '\n\n*Note: For full AI-powered analysis, integrate with your preferred AI service (OpenAI, Anthropic, etc.)*';
                    setBrainResponse(response_text);
                } catch (err) {
                    setBrainResponse('An error occurred whilst processing your query. Please try again.');
                } finally {
                    setIsBrainLoading(false);
                }
            };

            return (
                <div style={{
                    fontFamily: 'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                    backgroundColor: '#f8faf6',
                    minHeight: '100vh',
                    padding: '20px'
                }}>
                    <header style={{
                        maxWidth: '1200px',
                        margin: '0 auto',
                        marginBottom: '32px'
                    }}>
                        <div style={{
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'center',
                            marginBottom: '20px'
                        }}>
                            <h1 style={{
                                fontSize: '32px',
                                fontWeight: '700',
                                color: '#374528',
                                margin: '0'
                            }}>
                                Meeting Notes AI Assistant
                            </h1>
                            
                            <button
                                onClick={() => setShowBrain(!showBrain)}
                                style={{
                                    padding: '12px 20px',
                                    borderRadius: '8px',
                                    border: '2px solid #374528',
                                    backgroundColor: showBrain ? '#374528' : 'transparent',
                                    color: showBrain ? 'white' : '#374528',
                                    fontSize: '16px',
                                    fontWeight: '600',
                                    cursor: 'pointer',
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '8px'
                                }}
                            >
                                üß† Brain ({storedMeetings.length})
                            </button>
                        </div>
                    </header>

                    <main style={{
                        maxWidth: '1200px',
                        margin: '0 auto',
                        display: 'grid',
                        gridTemplateColumns: showBrain ? '1fr 1fr' : '1fr',
                        gap: '32px'
                    }}>
                        {/* Main Content */}
                        <div>
                            {/* Success/Error Messages */}
                            {showSaveSuccess && (
                                <div style={{
                                    backgroundColor: '#d4edda',
                                    border: '1px solid #c3e6cb',
                                    borderRadius: '8px',
                                    padding: '12px',
                                    marginBottom: '20px',
                                    color: '#155724'
                                }}>
                                    ‚úÖ Meeting saved to Brain successfully!
                                </div>
                            )}

                            {saveError && (
                                <div style={{
                                    backgroundColor: '#f8d7da',
                                    border: '1px solid #f5c6cb',
                                    borderRadius: '8px',
                                    padding: '12px',
                                    marginBottom: '20px',
                                    color: '#721c24'
                                }}>
                                    ‚ùå {saveError}
                                </div>
                            )}

                            {/* File Upload Section */}
                            <section style={{
                                backgroundColor: 'white',
                                borderRadius: '12px',
                                padding: '24px',
                                boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                                marginBottom: '24px'
                            }}>
                                <h2 style={{
                                    fontSize: '20px',
                                    fontWeight: '600',
                                    marginBottom: '16px',
                                    color: '#374528'
                                }}>
                                    üìÅ Upload Meeting Files
                                </h2>
                                
                                <div className="custom-file-input">
                                    <input
                                        type="file"
                                        multiple
                                        accept=".txt,.docx,.pdf,.md"
                                        onChange={handleFileUpload}
                                        id="file-upload"
                                    />
                                    <label htmlFor="file-upload" style={{
                                        display: 'inline-block',
                                        padding: '12px 24px',
                                        backgroundColor: '#6b7c4e',
                                        color: 'white',
                                        borderRadius: '8px',
                                        cursor: 'pointer',
                                        fontSize: '14px',
                                        fontWeight: '500'
                                    }}>
                                        Choose Files
                                    </label>
                                </div>

                                {files.length > 0 && (
                                    <div style={{ marginTop: '16px' }}>
                                        <h3 style={{
                                            fontSize: '16px',
                                            fontWeight: '500',
                                            marginBottom: '8px',
                                            color: '#374528'
                                        }}>
                                            Uploaded Files:
                                        </h3>
                                        <div>
                                            {files.map((file, index) => (
                                                <div key={index} style={{
                                                    display: 'flex',
                                                    justifyContent: 'space-between',
                                                    alignItems: 'center',
                                                    padding: '8px 12px',
                                                    backgroundColor: '#f8faf6',
                                                    borderRadius: '6px',
                                                    marginBottom: '8px'
                                                }}>
                                                    <span style={{ fontSize: '14px', color: '#374528' }}>
                                                        {file.name}
                                                    </span>
                                                    <button
                                                        onClick={() => removeFile(index)}
                                                        style={{
                                                            background: 'none',
                                                            border: 'none',
                                                            color: '#dc3545',
                                                            cursor: 'pointer',
                                                            fontSize: '16px'
                                                        }}
                                                    >
                                                        ‚úï
                                                    </button>
                                                </div>
                                            ))}
                                        </div>
                                        <button
                                            onClick={extractFromFiles}
                                            disabled={isGenerating}
                                            style={{
                                                marginTop: '12px',
                                                padding: '10px 20px',
                                                backgroundColor: '#6b7c4e',
                                                color: 'white',
                                                border: 'none',
                                                borderRadius: '6px',
                                                cursor: isGenerating ? 'not-allowed' : 'pointer',
                                                opacity: isGenerating ? 0.6 : 1,
                                                fontSize: '14px',
                                                fontWeight: '500'
                                            }}
                                        >
                                            {isGenerating ? 'Extracting...' : 'Extract Content'}
                                        </button>
                                    </div>
                                )}
                            </section>

                            {/* Meeting Details Section */}
                            <section style={{
                                backgroundColor: 'white',
                                borderRadius: '12px',
                                padding: '24px',
                                boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                                marginBottom: '24px'
                            }}>
                                <h2 style={{
                                    fontSize: '20px',
                                    fontWeight: '600',
                                    marginBottom: '16px',
                                    color: '#374528'
                                }}>
                                    üìÖ Meeting Details
                                </h2>
                                
                                <div style={{
                                    display: 'grid',
                                    gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))',
                                    gap: '16px'
                                }}>
                                    <div>
                                        <label style={{
                                            display: 'block',
                                            marginBottom: '4px',
                                            fontSize: '14px',
                                            fontWeight: '500',
                                            color: '#374528'
                                        }}>
                                            Meeting Title
                                        </label>
                                        <input
                                            type="text"
                                            value={meetingTitle}
                                            onChange={(e) => setMeetingTitle(e.target.value)}
                                            placeholder="Enter meeting title"
                                            style={{
                                                width: '100%',
                                                padding: '8px 12px',
                                                border: '1px solid #d1d5db',
                                                borderRadius: '6px',
                                                fontSize: '14px'
                                            }}
                                        />
                                    </div>
                                    
                                    <div>
                                        <label style={{
                                            display: 'block',
                                            marginBottom: '4px',
                                            fontSize: '14px',
                                            fontWeight: '500',
                                            color: '#374528'
                                        }}>
                                            Date
                                        </label>
                                        <input
                                            type="date"
                                            value={meetingDate}
                                            onChange={(e) => setMeetingDate(e.target.value)}
                                            style={{
                                                width: '100%',
                                                padding: '8px 12px',
                                                border: '1px solid #d1d5db',
                                                borderRadius: '6px',
                                                fontSize: '14px'
                                            }}
                                        />
                                    </div>
                                    
                                    <div>
                                        <label style={{
                                            display: 'block',
                                            marginBottom: '4px',
                                            fontSize: '14px',
                                            fontWeight: '500',
                                            color: '#374528'
                                        }}>
                                            Time
                                        </label>
                                        <input
                                            type="time"
                                            value={meetingTime}
                                            onChange={(e) => setMeetingTime(e.target.value)}
                                            style={{
                                                width: '100%',
                                                padding: '8px 12px',
                                                border: '1px solid #d1d5db',
                                                borderRadius: '6px',
                                                fontSize: '14px'
                                            }}
                                        />
                                    </div>
                                    
                                    <div>
                                        <label style={{
                                            display: 'block',
                                            marginBottom: '4px',
                                            fontSize: '14px',
                                            fontWeight: '500',
                                            color: '#374528'
                                        }}>
                                            Location/Venue
                                        </label>
                                        <input
                                            type="text"
                                            value={location}
                                            onChange={(e) => setLocation(e.target.value)}
                                           placeholder="Meeting location"
                                           style={{
                                               width: '100%',
                                               padding: '8px 12px',
                                               border: '1px solid #d1d5db',
                                               borderRadius: '6px',
                                               fontSize: '14px'
                                           }}
                                       />
                                   </div>
                                   
                                   <div>
                                       <label style={{
                                           display: 'block',
                                           marginBottom: '4px',
                                           fontSize: '14px',
                                           fontWeight: '500',
                                           color: '#374528'
                                       }}>
                                           Company Attendees
                                       </label>
                                       <input
                                           type="text"
                                           value={companyAttendees}
                                           onChange={(e) => setCompanyAttendees(e.target.value)}
                                           placeholder="Company attendees"
                                           style={{
                                               width: '100%',
                                               padding: '8px 12px',
                                               border: '1px solid #d1d5db',
                                               borderRadius: '6px',
                                               fontSize: '14px'
                                           }}
                                       />
                                   </div>
                                   
                                   <div>
                                       <label style={{
                                           display: 'block',
                                           marginBottom: '4px',
                                           fontSize: '14px',
                                           fontWeight: '500',
                                           color: '#374528'
                                       }}>
                                           Client Attendees
                                       </label>
                                       <input
                                           type="text"
                                           value={clientAttendees}
                                           onChange={(e) => setClientAttendees(e.target.value)}
                                           placeholder="Client attendees"
                                           style={{
                                               width: '100%',
                                               padding: '8px 12px',
                                               border: '1px solid #d1d5db',
                                               borderRadius: '6px',
                                               fontSize: '14px'
                                           }}
                                       />
                                   </div>
                               </div>
                           </section>

                           {/* Raw Notes Section */}
                           <section style={{
                               backgroundColor: 'white',
                               borderRadius: '12px',
                               padding: '24px',
                               boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                               marginBottom: '24px'
                           }}>
                               <h2 style={{
                                   fontSize: '20px',
                                   fontWeight: '600',
                                   marginBottom: '16px',
                                   color: '#374528'
                               }}>
                                   üìù Raw Meeting Notes
                               </h2>
                               <textarea
                                   value={rawNotes}
                                   onChange={(e) => setRawNotes(e.target.value)}
                                   placeholder="Paste or type your meeting notes here..."
                                   style={{
                                       width: '100%',
                                       minHeight: '200px',
                                       padding: '12px',
                                       border: '1px solid #d1d5db',
                                       borderRadius: '8px',
                                       fontSize: '14px',
                                       lineHeight: '1.5',
                                       resize: 'vertical',
                                       fontFamily: 'inherit'
                                   }}
                               />
                               <button
                                   onClick={generateSummary}
                                   disabled={!rawNotes.trim() || isGenerating}
                                   style={{
                                       marginTop: '12px',
                                       padding: '12px 24px',
                                       backgroundColor: rawNotes.trim() ? '#6b7c4e' : '#9ca3af',
                                       color: 'white',
                                       border: 'none',
                                       borderRadius: '8px',
                                       cursor: rawNotes.trim() ? 'pointer' : 'not-allowed',
                                       fontSize: '14px',
                                       fontWeight: '500'
                                   }}
                               >
                                   {isGenerating ? 'üîÑ Generating Summary...' : '‚ú® Generate Professional Summary'}
                               </button>
                           </section>

                           {/* Summary Section */}
                           {summary && (
                               <section style={{
                                   backgroundColor: 'white',
                                   borderRadius: '12px',
                                   padding: '24px',
                                   boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                                   marginBottom: '24px'
                               }}>
                                   <div style={{
                                       display: 'flex',
                                       justifyContent: 'space-between',
                                       alignItems: 'center',
                                       marginBottom: '16px'
                                   }}>
                                       <h2 style={{
                                           fontSize: '20px',
                                           fontWeight: '600',
                                           color: '#374528',
                                           margin: '0'
                                       }}>
                                           üìã Professional Summary
                                       </h2>
                                       <button
                                           onClick={saveToBrain}
                                           disabled={!summary.trim()}
                                           style={{
                                               padding: '8px 16px',
                                               backgroundColor: summary.trim() ? '#6b7c4e' : '#9ca3af',
                                               color: 'white',
                                               border: 'none',
                                               borderRadius: '6px',
                                               cursor: summary.trim() ? 'pointer' : 'not-allowed',
                                               fontSize: '14px',
                                               fontWeight: '500'
                                           }}
                                       >
                                           üß† Save to Brain
                                       </button>
                                   </div>
                                   <div style={{
                                       padding: '16px',
                                       backgroundColor: '#f8faf6',
                                       borderRadius: '8px',
                                       border: '1px solid #e5e7eb',
                                       whiteSpace: 'pre-wrap',
                                       fontSize: '14px',
                                       lineHeight: '1.6'
                                   }}
                                   className="markdown-content"
                                   dangerouslySetInnerHTML={{
                                       __html: renderText(summary)
                                   }}>
                                   </div>
                               </section>
                           )}
                       </div>

                       {/* Brain Panel */}
                       {showBrain && (
                           <div style={{
                               backgroundColor: 'white',
                               borderRadius: '12px',
                               padding: '24px',
                               boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                               height: 'fit-content'
                           }}>
                               <h2 style={{ 
                                   fontSize: '20px', 
                                   fontWeight: '600', 
                                   marginBottom: '16px',
                                   color: '#374528',
                                   display: 'flex',
                                   alignItems: 'center',
                                   gap: '8px'
                               }}>
                                   üß† Meeting Brain
                               </h2>

                               {/* Query Section */}
                               <div style={{ marginBottom: '20px' }}>
                                   <label style={{
                                       display: 'block',
                                       marginBottom: '8px',
                                       fontSize: '14px',
                                       fontWeight: '500',
                                       color: '#374528'
                                   }}>
                                       Ask about your meetings:
                                   </label>
                                   <div style={{ display: 'flex', gap: '8px' }}>
                                       <input
                                           type="text"
                                           value={brainQuery}
                                           onChange={(e) => setBrainQuery(e.target.value)}
                                           placeholder="e.g., What action items were assigned to Maria?"
                                           onKeyPress={(e) => e.key === 'Enter' && handleBrainQuery()}
                                           style={{
                                               flex: 1,
                                               padding: '8px 12px',
                                               border: '1px solid #d1d5db',
                                               borderRadius: '6px',
                                               fontSize: '14px'
                                           }}
                                       />
                                       <button
                                           onClick={handleBrainQuery}
                                           disabled={!brainQuery.trim() || storedMeetings.length === 0 || isBrainLoading}
                                           style={{
                                               padding: '8px 16px',
                                               backgroundColor: (brainQuery.trim() && storedMeetings.length > 0) ? '#6b7c4e' : '#9ca3af',
                                               color: 'white',
                                               border: 'none',
                                               borderRadius: '6px',
                                               cursor: (brainQuery.trim() && storedMeetings.length > 0) ? 'pointer' : 'not-allowed',
                                               fontSize: '14px',
                                               fontWeight: '500'
                                           }}
                                       >
                                           {isBrainLoading ? 'üîÑ' : 'üîç'}
                                       </button>
                                   </div>
                               </div>

                               {/* Response Section */}
                               {brainResponse && (
                                   <div style={{
                                       padding: '12px',
                                       backgroundColor: '#f8faf6',
                                       borderRadius: '8px',
                                       marginBottom: '20px',
                                       border: '1px solid #e5e7eb'
                                   }}>
                                       <h4 style={{
                                           fontSize: '14px',
                                           fontWeight: '600',
                                           marginBottom: '8px',
                                           color: '#374528'
                                       }}>
                                           Response:
                                       </h4>
                                       <div style={{
                                           fontSize: '14px',
                                           lineHeight: '1.5',
                                           whiteSpace: 'pre-wrap'
                                       }}
                                       className="markdown-content"
                                       dangerouslySetInnerHTML={{
                                           __html: renderText(brainResponse)
                                       }}>
                                       </div>
                                   </div>
                               )}

                               {/* Stored Meetings List */}
                               <div>
                                   <h3 style={{
                                       fontSize: '16px',
                                       fontWeight: '600',
                                       marginBottom: '12px',
                                       color: '#374528'
                                   }}>
                                       Stored Meetings ({storedMeetings.length})
                                   </h3>
                                   
                                   {isLoadingMeetings ? (
                                       <div style={{ textAlign: 'center', padding: '20px' }}>
                                           <div>üîÑ Loading meetings...</div>
                                       </div>
                                   ) : storedMeetings.length === 0 ? (
                                       <div style={{
                                           textAlign: 'center',
                                           padding: '20px',
                                           color: '#6b7280',
                                           fontSize: '14px'
                                       }}>
                                           No meetings stored yet. Generate and save a summary to get started!
                                       </div>
                                   ) : (
                                       <div style={{ maxHeight: '400px', overflowY: 'auto' }}>
                                           {storedMeetings.map((meeting) => (
                                               <div key={meeting.id} style={{
                                                   padding: '12px',
                                                   backgroundColor: '#f8faf6',
                                                   borderRadius: '8px',
                                                   marginBottom: '8px',
                                                   border: '1px solid #e5e7eb'
                                               }}>
                                                   <div style={{
                                                       display: 'flex',
                                                       justifyContent: 'space-between',
                                                       alignItems: 'flex-start',
                                                       marginBottom: '8px'
                                                   }}>
                                                       <div>
                                                           <h4 style={{
                                                               fontSize: '14px',
                                                               fontWeight: '600',
                                                               margin: '0 0 4px 0',
                                                               color: '#374528'
                                                           }}>
                                                               {meeting.title}
                                                           </h4>
                                                           <div style={{
                                                               fontSize: '12px',
                                                               color: '#6b7280'
                                                           }}>
                                                               üìÖ {meeting.date} {meeting.time && `at ${meeting.time}`}
                                                               {meeting.venue && ` ‚Ä¢ üìç ${meeting.venue}`}
                                                           </div>
                                                       </div>
                                                       <button
                                                           onClick={() => deleteMeeting(meeting.id)}
                                                           style={{
                                                               background: 'none',
                                                               border: 'none',
                                                               color: '#dc3545',
                                                               cursor: 'pointer',
                                                               fontSize: '14px',
                                                               padding: '4px'
                                                           }}
                                                           title="Delete meeting"
                                                       >
                                                           üóëÔ∏è
                                                       </button>
                                                   </div>
                                                   {(meeting.companyAttendees || meeting.clientAttendees) && (
                                                       <div style={{
                                                           fontSize: '12px',
                                                           color: '#6b7280',
                                                           marginBottom: '8px'
                                                       }}>
                                                           {meeting.companyAttendees && `üë• ${meeting.companyAttendees}`}
                                                           {meeting.companyAttendees && meeting.clientAttendees && ' ‚Ä¢ '}
                                                           {meeting.clientAttendees && `ü§ù ${meeting.clientAttendees}`}
                                                       </div>
                                                   )}
                                                   <div style={{
                                                       fontSize: '12px',
                                                       color: '#374528',
                                                       maxHeight: '60px',
                                                       overflow: 'hidden',
                                                       textOverflow: 'ellipsis'
                                                   }}>
                                                       {meeting.summary.substring(0, 150)}...
                                                   </div>
                                               </div>
                                           ))}
                                       </div>
                                   )}
                               </div>
                           </div>
                       )}
                   </main>
               </div>
           );
       }

       ReactDOM.render(<MeetingNotesApp />, document.getElementById('root'));
   </script>
</body>
</html>
