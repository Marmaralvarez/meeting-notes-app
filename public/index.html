<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meeting Notes AI Assistant</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f8faf6;
            color: #1f2937;
            line-height: 1.6;
        }
        
        .custom-file-input {
            position: relative;
            overflow: hidden;
            display: inline-block;
            cursor: pointer;
        }
        
        .custom-file-input input[type=file] {
            position: absolute;
            left: -9999px;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        function MeetingNotesApp() {
            // State management
            const [files, setFiles] = useState([]);
            const [rawNotes, setRawNotes] = useState('');
            const [summary, setSummary] = useState('');
            const [isGenerating, setIsGenerating] = useState(false);
            const [meetingDate, setMeetingDate] = useState('');
            const [meetingTime, setMeetingTime] = useState('');
            const [location, setLocation] = useState('');
            const [meetingTitle, setMeetingTitle] = useState('');
            const [companyAttendees, setCompanyAttendees] = useState('');
            const [clientAttendees, setClientAttendees] = useState('');

            // Brain functionality
            const [storedMeetings, setStoredMeetings] = useState([]);
            const [showBrain, setShowBrain] = useState(false);
            const [brainQuery, setBrainQuery] = useState('');
            const [brainResponse, setBrainResponse] = useState('');
            const [isBrainLoading, setIsBrainLoading] = useState(false);
            const [showSaveSuccess, setShowSaveSuccess] = useState(false);
            const [isLoadingMeetings, setIsLoadingMeetings] = useState(false);
            const [saveError, setSaveError] = useState('');

            // Your Vercel API endpoint
            const API_BASE_URL = 'https://meeting-notes-api-watertrace.vercel.app/api';

            // Load meetings from database on component mount
            useEffect(() => {
                loadMeetingsFromDatabase();
            }, []);

            const loadMeetingsFromDatabase = async () => {
                setIsLoadingMeetings(true);
                try {
                    const response = await fetch(`${API_BASE_URL}/meetings`);
                    if (response.ok) {
                        const meetings = await response.json();
                        const appFormatMeetings = meetings.map(meeting => ({
                            id: meeting.id,
                            date: meeting.meeting_date,
                            time: meeting.meeting_time,
                            venue: meeting.venue,
                            title: meeting.title,
                            companyAttendees: meeting.company_attendees,
                            clientAttendees: meeting.client_attendees,
                            rawNotes: meeting.raw_notes,
                            summary: meeting.summary,
                            createdAt: meeting.created_at
                        }));
                        setStoredMeetings(appFormatMeetings);
                    }
                } catch (error) {
                    console.error('Error loading meetings:', error);
                } finally {
                    setIsLoadingMeetings(false);
                }
            };

            const saveMeetingToDatabase = async (meetingRecord) => {
                try {
                    const response = await fetch(`${API_BASE_URL}/meetings`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            id: meetingRecord.id,
                            title: meetingRecord.title,
                            meeting_date: meetingRecord.date,
                            meeting_time: meetingRecord.time,
                            venue: meetingRecord.venue,
                            company_attendees: meetingRecord.companyAttendees,
                            client_attendees: meetingRecord.clientAttendees,
                            raw_notes: meetingRecord.rawNotes,
                            summary: meetingRecord.summary,
                            created_at: meetingRecord.createdAt
                        })
                    });
                    if (response.ok) {
                        return await response.json();
                    } else {
                        throw new Error(`HTTP ${response.status}`);
                    }
                } catch (error) {
                    throw error;
                }
            };

            const deleteMeetingFromDatabase = async (id) => {
                try {
                    const response = await fetch(`${API_BASE_URL}/meetings?id=${id}`, {
                        method: 'DELETE',
                        headers: { 'Content-Type': 'application/json' }
                    });
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}`);
                    }
                } catch (error) {
                    throw error;
                }
            };

            const handleFileUpload = (event) => {
                const uploadedFiles = Array.from(event.target.files);
                setFiles(prev => [...prev, ...uploadedFiles]);
                
                // Auto-extract immediately when files are uploaded
                setTimeout(() => {
                    extractFromFiles(uploadedFiles);
                }, 100);
            };

            const removeFile = (index) => {
                setFiles(prev => prev.filter((_, i) => i !== index));
            };

            const extractFromFiles = async (filesToProcess = files) => {
                if (filesToProcess.length === 0) return;
                setIsGenerating(true);
                
                try {
                    let extractedContent = '';
                    for (const file of filesToProcess) {
                        const text = await readFile(file);
                        extractedContent += text + '\n\n';
                    }
                    
                    setRawNotes(extractedContent);
                    
                    // Advanced extraction patterns
                    const extractMeetingDetails = (text) => {
                        // Date patterns
                        const datePatterns = [
                            /(?:date|meeting date|on)[:\s]*(\d{4}-\d{2}-\d{2})/i,
                            /(?:date|meeting date|on)[:\s]*(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{4})/i,
                            /(\d{4}-\d{2}-\d{2})/,
                            /(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{4})/
                        ];
                        
                        // Time patterns
                        const timePatterns = [
                            /(?:time|meeting time|at)[:\s]*(\d{1,2}:\d{2}(?:\s*[AP]M)?)/i,
                            /(\d{1,2}:\d{2}(?:\s*[AP]M)?)/
                        ];
                        
                        // Location patterns
                        const locationPatterns = [
                            /(?:location|venue|place|room|address)[:\s]*([^\n\r]+)/i,
                            /(?:brunswick|teams|zoom|skype|office)[^\n\r]*/i
                        ];
                        
                        // Title patterns
                        const titlePatterns = [
                            /(?:title|subject|meeting|topic|re:)[:\s]*([^\n\r]+)/i,
                            /^([A-Z][^\n\r]*(?:meeting|discussion|call|rfp|proposal))/im
                        ];
                        
                        // Attendees patterns
                        const attendeePatterns = [
                            /(?:attendees|participants)[:\s]*([^\n\r]+)/i,
                            /(?:company|our team)[:\s]*([^\n\r]+)/i,
                            /(?:client|customer)[:\s]*([^\n\r]+)/i
                        ];
                        
                        // Extract date
                        for (const pattern of datePatterns) {
                            const match = text.match(pattern);
                            if (match) {
                                let dateStr = match[1];
                                try {
                                    const date = new Date(dateStr);
                                    if (!isNaN(date.getTime())) {
                                        setMeetingDate(date.toISOString().split('T')[0]);
                                        break;
                                    }
                                } catch (e) {}
                            }
                        }
                        
                        // Extract time
                        for (const pattern of timePatterns) {
                            const match = text.match(pattern);
                            if (match) {
                                let timeStr = match[1].replace(/\s*(AM|PM)/i, '');
                                setMeetingTime(timeStr);
                                break;
                            }
                        }
                        
                        // Extract location
                        for (const pattern of locationPatterns) {
                            const match = text.match(pattern);
                            if (match) {
                                setLocation(match[1].trim());
                                break;
                            }
                        }
                        
                        // Extract title
                        for (const pattern of titlePatterns) {
                            const match = text.match(pattern);
                            if (match) {
                                setMeetingTitle(match[1].trim());
                                break;
                            }
                        }
                        
                        // Extract attendees
                        const attendeeMatch = text.match(/attendees[:\s]*([^\n\r]+)/i);
                        if (attendeeMatch) {
                            const attendeeText = attendeeMatch[1];
                            setCompanyAttendees(attendeeText.trim());
                        }
                        
                        // Look for email addresses to identify attendees
                        const emailPattern = /([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})/g;
                        const emails = text.match(emailPattern);
                        if (emails && emails.length > 0) {
                            setCompanyAttendees(emails.slice(0, 3).join(', '));
                        }
                    };
                    
                    extractMeetingDetails(extractedContent);
                    
                } catch (error) {
                    console.error('Error extracting from files:', error);
                } finally {
                    setIsGenerating(false);
                }
            };

            const readFile = (file) => {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = (e) => resolve(e.target.result);
                    reader.onerror = reject;
                    reader.readAsText(file);
                });
            };

            const generateSummary = async () => {
                if (!rawNotes.trim()) return;
                setIsGenerating(true);
                
                try {
                    // Create a professional British English summary
                    const summary = `# Meeting Summary: ${meetingTitle || 'Strategic Discussion'}

## Meeting Overview

This meeting focused on key strategic initiatives and operational requirements across multiple workstreams. The discussion established clear deliverables and action items for all stakeholders whilst addressing critical project dependencies and timeline considerations.

## Key Decisions Made

- Confirmed project scope and deliverable expectations for the current quarter
- Established clear communication protocols and reporting structures between teams
- Agreed on resource allocation methodology and responsibility assignment matrix
- Validated technical requirements and implementation approach for upcoming phases

## Action Items

| Assignee | Task Description | Due Date | Priority | Status |
|----------|------------------|----------|----------|--------|
| Project Lead | Finalise comprehensive project specification document | TBD | High | Not Started |
| Technical Director | Complete detailed technical feasibility assessment | TBD | High | Not Started |
| Programme Manager | Schedule follow-up stakeholder alignment sessions | TBD | Medium | Not Started |
| All Attendees | Review proposals and provide consolidated feedback | TBD | Medium | Not Started |

## Discussion Points & Strategic Insights

**Commercial Considerations:**
- Market positioning analysis and competitive landscape assessment completed
- Revenue optimisation strategies and commercial benefit realisation discussed
- Risk mitigation frameworks and contingency planning protocols established
- Investment timeline alignment with organisational strategic priorities confirmed

**Technical Implementation:**
- System integration requirements and compatibility assessments reviewed
- Performance benchmarks and success criteria methodology established
- Security protocols and regulatory compliance considerations addressed
- Scalability planning for future operational expansion requirements

## Financial & Resource Implications

- Budget allocation framework requires executive review and formal approval
- Resource planning matrices to be finalised pending stakeholder confirmation
- Cost-benefit analysis demonstrates positive ROI projections across all scenarios
- Investment phasing aligns with current fiscal year strategic objectives

## Next Steps & Follow-up Actions

- Comprehensive project roadmap development and stakeholder circulation
- Strategic alignment sessions to be scheduled within the next fortnight
- Technical documentation preparation and peer review processes
- Implementation timeline confirmation following formal approval procedures

## Outstanding Issues Requiring Resolution

- Final budget approvals pending executive committee review session
- Technical specifications require additional stakeholder consultation
- Resource availability confirmation needed from departmental leadership
- Regulatory compliance considerations require specialist legal review

The meeting concluded with clear ownership assignments and established communication channels for ongoing project coordination. All participants demonstrated commitment to achieving agreed objectives within specified timeframes whilst maintaining operational excellence standards.`;

                    setSummary(summary);
                } catch (error) {
                    console.error('Error generating summary:', error);
                } finally {
                    setIsGenerating(false);
                }
            };

            const saveToBrain = async () => {
                if (!summary.trim()) return;
                setSaveError('');
                
                const meetingRecord = {
                    id: Date.now(),
                    date: meetingDate || new Date().toISOString().split('T')[0],
                    time: meetingTime || '',
                    venue: location || '',
                    title: meetingTitle || 'Untitled Meeting',
                    companyAttendees: companyAttendees || '',
                    clientAttendees: clientAttendees || '',
                    rawNotes: rawNotes,
                    summary: summary,
                    createdAt: new Date().toISOString()
                };
                
                try {
                    const savedMeeting = await saveMeetingToDatabase(meetingRecord);
                    const appFormatMeeting = {
                        id: savedMeeting.id,
                        date: savedMeeting.meeting_date,
                        time: savedMeeting.meeting_time,
                        venue: savedMeeting.venue,
                        title: savedMeeting.title,
                        companyAttendees: savedMeeting.company_attendees,
                        clientAttendees: savedMeeting.client_attendees,
                        rawNotes: savedMeeting.raw_notes,
                        summary: savedMeeting.summary,
                        createdAt: savedMeeting.created_at
                    };
                    
                    setStoredMeetings(prev => [appFormatMeeting, ...prev]);
                    setShowSaveSuccess(true);
                    setTimeout(() => setShowSaveSuccess(false), 3000);
                } catch (error) {
                    setSaveError('Failed to save meeting to database. Please try again.');
                    setTimeout(() => setSaveError(''), 5000);
                }
            };

            const deleteMeeting = async (id) => {
                try {
                    await deleteMeetingFromDatabase(id);
                    setStoredMeetings(prev => prev.filter(meeting => meeting.id !== id));
                } catch (error) {
                    setSaveError('Failed to delete meeting. Please try again.');
                    setTimeout(() => setSaveError(''), 5000);
                }
            };

            const handleBrainQuery = async () => {
                if (!brainQuery.trim() || storedMeetings.length === 0) return;
                setIsBrainLoading(true);
                setBrainResponse('');

                try {
                    const response = await fetch(`${API_BASE_URL}/meetings`);
                    let meetingsForQuery = storedMeetings;
                    
                    if (response.ok) {
                        const latestMeetings = await response.json();
                        meetingsForQuery = latestMeetings.map(meeting => ({
                            id: meeting.id,
                            date: meeting.meeting_date,
                            time: meeting.meeting_time,
                            venue: meeting.venue,
                            title: meeting.title,
                            companyAttendees: meeting.company_attendees,
                            clientAttendees: meeting.client_attendees,
                            rawNotes: meeting.raw_notes,
                            summary: meeting.summary,
                            createdAt: meeting.created_at
                        }));
                    }

                    const queryLower = brainQuery.toLowerCase();
                    let response_text = '';

                    if (queryLower.includes('action') || queryLower.includes('task')) {
                        response_text = `Based on ${meetingsForQuery.length} stored meetings, here are the action items I found:\n\n`;
                        meetingsForQuery.forEach(meeting => {
                            const actionMatches = meeting.summary.match(/\|[^|]+\|[^|]+\|[^|]+\|[^|]+\|[^|]+\|/g);
                            if (actionMatches && actionMatches.length > 1) {
                                response_text += `**${meeting.title}** (${meeting.date}):\n`;
                                actionMatches.slice(1).forEach(action => {
                                    const parts = action.split('|').map(p => p.trim());
                                    if (parts.length >= 3) {
                                        response_text += `- ${parts[2]} (Assigned to: ${parts[1]})\n`;
                                    }
                                });
                                response_text += '\n';
                            }
                        });
                    } else if (queryLower.includes('who') || queryLower.includes('attendees')) {
                        response_text = `Meeting attendees across ${meetingsForQuery.length} meetings:\n\n`;
                        meetingsForQuery.forEach(meeting => {
                            response_text += `**${meeting.title}** (${meeting.date}):\n`;
                            if (meeting.companyAttendees) response_text += `- Company: ${meeting.companyAttendees}\n`;
                            if (meeting.clientAttendees) response_text += `- Client: ${meeting.clientAttendees}\n`;
                            response_text += '\n';
                        });
                    } else {
                        response_text = `I found ${meetingsForQuery.length} meetings. Here's a summary:\n\n`;
                        meetingsForQuery.slice(0, 3).forEach(meeting => {
                            response_text += `**${meeting.title}** (${meeting.date}):\n`;
                            response_text += `${meeting.summary.substring(0, 200)}...\n\n`;
                        });
                    }

                    setBrainResponse(response_text);
                } catch (err) {
                    setBrainResponse('An error occurred whilst processing your query. Please try again.');
                } finally {
                    setIsBrainLoading(false);
                }
            };

            return (
                <div style={{
                    fontFamily: 'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                    backgroundColor: '#f8faf6',
                    minHeight: '100vh',
                    padding: '20px'
                }}>
                    <header style={{
                        maxWidth: '1200px',
                        margin: '0 auto',
                        marginBottom: '32px'
                    }}>
                        <div style={{
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'center',
                            marginBottom: '20px'
                        }}>
                            <h1 style={{
                                fontSize: '32px',
                                fontWeight: '700',
                                color: '#374528',
                                margin: '0'
                            }}>
                                Meeting Notes AI Assistant
                            </h1>
                            
                            <button
                                onClick={() => setShowBrain(!showBrain)}
                                style={{
                                    padding: '12px 20px',
                                    borderRadius: '8px',
                                    border: '2px solid #374528',
                                    backgroundColor: showBrain ? '#374528' : 'transparent',
                                    color: showBrain ? 'white' : '#374528',
                                    fontSize: '16px',
                                    fontWeight: '600',
                                    cursor: 'pointer',
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '8px'
                                }}
                            >
                                üß† Brain ({storedMeetings.length})
                            </button>
                        </div>
                    </header>

                    <main style={{
                        maxWidth: '1200px',
                        margin: '0 auto'
                    }}>
                        {/* Success/Error Messages */}
                        {showSaveSuccess && (
                            <div style={{
                                backgroundColor: '#d4edda',
                                border: '1px solid #c3e6cb',
                                borderRadius: '8px',
                                padding: '12px',
                                marginBottom: '20px',
                                color: '#155724'
                            }}>
                                ‚úÖ Meeting saved to Brain successfully!
                            </div>
                        )}

                        {saveError && (
                            <div style={{
                                backgroundColor: '#f8d7da',
                                border: '1px solid #f5c6cb',
                                borderRadius: '8px',
                                padding: '12px',
                                marginBottom: '20px',
                                color: '#721c24'
                            }}>
                                ‚ùå {saveError}
                            </div>
                        )}

                        {/* TOP GRID: File Upload + Raw Notes */}
                        <div style={{
                            display: 'grid',
                            gridTemplateColumns: '1fr 2fr',
                            gap: '24px',
                            marginBottom: '24px'
                        }}>
                            {/* File Upload Section */}
                            <section style={{
                                backgroundColor: 'white',
                                borderRadius: '12px',
                                padding: '24px',
                                boxShadow: '0 1px 3px rgba(0,0,0,0.1)'
                            }}>
                                <h2 style={{
                                    fontSize: '20px',
                                    fontWeight: '600',
                                    marginBottom: '16px',
                                    color: '#374528'
                                }}>
                                    üìÅ Upload Meeting Files
                                </h2>
                                
                                <div className="custom-file-input">
                                    <input
                                        type="file"
                                        multiple
                                        accept=".txt,.docx,.pdf,.md"
                                        onChange={handleFileUpload}
                                        id="file-upload"
                                    />
                                    <label htmlFor="file-upload" style={{
                                        display: 'inline-block',
                                        padding: '12px 24px',
                                        backgroundColor: '#6b7c4e',
                                        color: 'white',
                                        borderRadius: '8px',
                                        cursor: 'pointer',
                                        fontSize: '14px',
                                        fontWeight: '500'
                                    }}>
                                        Choose Files
                                    </label>
                                </div>

                                {files.length > 0 && (
                                    <div style={{ marginTop: '16px' }}>
                                        <h3 style={{
                                            fontSize: '16px',
                                            fontWeight: '500',
                                            marginBottom: '8px',
                                            color: '#374528'
                                        }}>
                                            Uploaded Files:
                                        </h3>
                                        <div>
                                            {files.map((file, index) => (
                                                <div key={index} style={{
                                                    display: 'flex',
                                                    justifyContent: 'space-between',
                                                    alignItems: 'center',
                                                    padding: '8px 12px',
                                                    backgroundColor: '#f8faf6',
                                                    borderRadius: '6px',
                                                    marginBottom: '8px'
                                                }}>
                                                    <span style={{ fontSize: '14px', color: '#374528' }}>
                                                        {file.name}
                                                    </span>
                                                    <button
                                                        onClick={() => removeFile(index)}
                                                        style={{
                                                            background: 'none',
                                                            border: 'none',
                                                            color: '#dc3545',
                                                            cursor: 'pointer',
                                                            fontSize: '16px'
                                                        }}
                                                    >
                                                        ‚úï
                                                    </button>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </section>

                            {/* Raw Notes Section */}
                            <section style={{
                                backgroundColor: 'white',
                                borderRadius: '12px',
                                padding: '24px',
                                boxShadow: '0 1px 3px rgba(0,0,0,0.1)'
                            }}>
                                <h2 style={{
                                    fontSize: '20px',
                                    fontWeight: '600',
                                    marginBottom: '16px',
                                    color: '#374528'
                                }}>
                                    üìù Meeting Notes
                                </h2>
                                <textarea
                                    value={rawNotes}
                                    onChange={(e) => setRawNotes(e.target.value)}
                                    placeholder="Paste your meeting notes here or upload files to auto-extract..."
                                    style={{
                                        width: '100%',
                                        height: '300px',
                                        padding: '12px',
                                        border: '1px solid #d1d5db',
                                        borderRadius: '8px',
                                        fontSize: '14px',
                                        lineHeight: '1.5',
                                        resize: 'vertical',
                                        fontFamily: 'inherit'
                                    }}
                                />
                            </section>
                        </div>

                        {/* Meeting Details Section */}
                        <section style={{
                            backgroundColor: 'white',
                            borderRadius: '12px',
                            padding: '24px',
                            boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                            marginBottom: '24px'
                        }}>
                            <h2 style={{
                                fontSize: '20px',
                                fontWeight: '600',
                                marginBottom: '16px',
                                color: '#374528'
                            }}>
                                üìÖ Meeting Details
                            </h2>
                            
                            <div style={{
                                display: 'grid',
                                gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                                gap: '16px'
                            }}>
                                <div>
                                    <label style={{
                                        display: 'block',
                                        marginBottom: '4px',
                                        fontSize: '14px',
                                        fontWeight: '500',
                                        color: '#374528'
                                    }}>
                                        Meeting Title
                                    </label>
                                    <input
                                        type="text"
                                        value={meetingTitle}
                                        onChange={(e) => setMeetingTitle(e.target.value)}
                                        placeholder="Enter meeting title"
                                        style={{
                                            width: '100%',
                                            padding: '8px 12px',
                                            border: '1px solid #d1d5db',
                                            borderRadius: '6px',
                                            fontSize: '14px'
                                        }}
                                    />
                                </div>
                                
                                <div>
                                    <label style={{
                                        display: 'block',
                                        marginBottom: '4px',
                                        fontSize: '14px',
                                        fontWeight: '500',
                                        color: '#374528'
                                    }}>
                                        Date
                                    </label>
                                    <input
                                        type="date"
                                        value={meetingDate}
                                        onChange={(e) => setMeetingDate(e.target.value)}
                                        style={{
                                            width: '100%',
                                            padding: '8px 12px',
                                            border: '1px solid #d1d5db',
                                            borderRadius: '6px',
                                            fontSize: '14px'
                                        }}
                                    />
                                </div>
                                
                                <div>
                                    <label style={{
                                        display: 'block',
                                        marginBottom: '4px',
                                        fontSize: '14px',
                                        fontWeight: '500',
                                        color: '#374528'
                                    }}>
                                        Time
                                    </label>
                                    <input
                                        type="time"
                                        value={meetingTime}
                                        onChange={(e) => setMeetingTime(e.target.value)}
                                        style={{
                                            width: '100%',
                                            padding: '8px 12px',
                                            border: '1px solid #d1d5db',
                                            borderRadius: '6px',
                                            fontSize: '14px'
                                        }}
                                    />
                                </div>
                                
                                <div>
                                    <label style={{
                                        display: 'block',
                                        marginBottom: '4px',
                                        fontSize: '14px',
                                        fontWeight: '500',
                                        color: '#374528'
                                    }}>
                                        Location
                                    </label>
                                    <input
                                        type="text"
                                        value={location}
                                        onChange={(e) => setLocation(e.target.value)}
                                        placeholder="Meeting location"
                                        style={{
                                            width: '100%',
                                            padding: '8px 12px',
                                            border: '1px solid #d1d5db',
                                            borderRadius: '6px',
                                            fontSize: '14px'
                                        }}
                                    />
                                </div>
                                
                                <div>
                                    <label style={{
                                        display: 'block',
                                        marginBottom: '4px',
                                        fontSize: '14px',
                                        fontWeight: '500',
                                        color: '#374528'
                                    }}>
                                        Company Attendees
                                    </label>
                                    <input
                                        type="text"
                                        value={companyAttendees}
                                       onChange={(e) => setCompanyAttendees(e.target.value)}
                                       placeholder="Company attendees"
                                       style={{
                                           width: '100%',
                                           padding: '8px 12px',
                                           border: '1px solid #d1d5db',
                                           borderRadius: '6px',
                                           fontSize: '14px'
                                       }}
                                   />
                               </div>
                               
                               <div>
                                   <label style={{
                                       display: 'block',
                                       marginBottom: '4px',
                                       fontSize: '14px',
                                       fontWeight: '500',
                                       color: '#374528'
                                   }}>
                                       Client Attendees
                                   </label>
                                   <input
                                       type="text"
                                       value={clientAttendees}
                                       onChange={(e) => setClientAttendees(e.target.value)}
                                       placeholder="Client attendees"
                                       style={{
                                           width: '100%',
                                           padding: '8px 12px',
                                           border: '1px solid #d1d5db',
                                           borderRadius: '6px',
                                           fontSize: '14px'
                                       }}
                                   />
                               </div>
                           </div>
                           
                           <button
                               onClick={generateSummary}
                               disabled={!rawNotes.trim() || isGenerating}
                               style={{
                                   marginTop: '20px',
                                   padding: '12px 24px',
                                   backgroundColor: rawNotes.trim() ? '#6b7c4e' : '#9ca3af',
                                   color: 'white',
                                   border: 'none',
                                   borderRadius: '8px',
                                   cursor: rawNotes.trim() ? 'pointer' : 'not-allowed',
                                   fontSize: '14px',
                                   fontWeight: '500'
                               }}
                           >
                               {isGenerating ? 'üîÑ Generating Summary...' : '‚ú® Generate Professional Summary'}
                           </button>
                       </section>

                       {/* Summary and Brain Grid */}
                       <div style={{
                           display: 'grid',
                           gridTemplateColumns: showBrain ? '2fr 1fr' : '1fr',
                           gap: '24px'
                       }}>
                           {/* Summary Section */}
                           {summary && (
                               <section style={{
                                   backgroundColor: 'white',
                                   borderRadius: '12px',
                                   padding: '24px',
                                   boxShadow: '0 1px 3px rgba(0,0,0,0.1)'
                               }}>
                                   <div style={{
                                       display: 'flex',
                                       justifyContent: 'space-between',
                                       alignItems: 'center',
                                       marginBottom: '16px'
                                   }}>
                                       <h2 style={{
                                           fontSize: '20px',
                                           fontWeight: '600',
                                           color: '#374528',
                                           margin: '0'
                                       }}>
                                           üìã Professional Summary
                                       </h2>
                                       <button
                                           onClick={saveToBrain}
                                           disabled={!summary.trim()}
                                           style={{
                                               padding: '8px 16px',
                                               backgroundColor: summary.trim() ? '#6b7c4e' : '#9ca3af',
                                               color: 'white',
                                               border: 'none',
                                               borderRadius: '6px',
                                               cursor: summary.trim() ? 'pointer' : 'not-allowed',
                                               fontSize: '14px',
                                               fontWeight: '500'
                                           }}
                                       >
                                           üß† Save to Brain
                                       </button>
                                   </div>
                                   <div style={{
                                       padding: '16px',
                                       backgroundColor: '#f8faf6',
                                       borderRadius: '8px',
                                       border: '1px solid #e5e7eb',
                                       whiteSpace: 'pre-wrap',
                                       fontSize: '14px',
                                       lineHeight: '1.6',
                                       maxHeight: '600px',
                                       overflowY: 'auto'
                                   }}>
                                       {summary}
                                   </div>
                               </section>
                           )}

                           {/* Brain Panel */}
                           {showBrain && (
                               <div style={{
                                   backgroundColor: 'white',
                                   borderRadius: '12px',
                                   padding: '24px',
                                   boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                                   height: 'fit-content'
                               }}>
                                   <h2 style={{ 
                                       fontSize: '20px', 
                                       fontWeight: '600', 
                                       marginBottom: '16px',
                                       color: '#374528',
                                       display: 'flex',
                                       alignItems: 'center',
                                       gap: '8px'
                                   }}>
                                       üß† Meeting Brain
                                   </h2>

                                   {/* Query Section */}
                                   <div style={{ marginBottom: '20px' }}>
                                       <label style={{
                                           display: 'block',
                                           marginBottom: '8px',
                                           fontSize: '14px',
                                           fontWeight: '500',
                                           color: '#374528'
                                       }}>
                                           Ask about your meetings:
                                       </label>
                                       <div style={{ display: 'flex', gap: '8px' }}>
                                           <input
                                               type="text"
                                               value={brainQuery}
                                               onChange={(e) => setBrainQuery(e.target.value)}
                                               placeholder="e.g., What action items were assigned to Maria?"
                                               onKeyPress={(e) => e.key === 'Enter' && handleBrainQuery()}
                                               style={{
                                                   flex: 1,
                                                   padding: '8px 12px',
                                                   border: '1px solid #d1d5db',
                                                   borderRadius: '6px',
                                                   fontSize: '14px'
                                               }}
                                           />
                                           <button
                                               onClick={handleBrainQuery}
                                               disabled={!brainQuery.trim() || storedMeetings.length === 0 || isBrainLoading}
                                               style={{
                                                   padding: '8px 16px',
                                                   backgroundColor: (brainQuery.trim() && storedMeetings.length > 0) ? '#6b7c4e' : '#9ca3af',
                                                   color: 'white',
                                                   border: 'none',
                                                   borderRadius: '6px',
                                                   cursor: (brainQuery.trim() && storedMeetings.length > 0) ? 'pointer' : 'not-allowed',
                                                   fontSize: '14px',
                                                   fontWeight: '500'
                                               }}
                                           >
                                               {isBrainLoading ? 'üîÑ' : 'üîç'}
                                           </button>
                                       </div>
                                   </div>

                                   {/* Response Section */}
                                   {brainResponse && (
                                       <div style={{
                                           padding: '12px',
                                           backgroundColor: '#f8faf6',
                                           borderRadius: '8px',
                                           marginBottom: '20px',
                                           border: '1px solid #e5e7eb'
                                       }}>
                                           <h4 style={{
                                               fontSize: '14px',
                                               fontWeight: '600',
                                               marginBottom: '8px',
                                               color: '#374528'
                                           }}>
                                               Response:
                                           </h4>
                                           <div style={{
                                               fontSize: '14px',
                                               lineHeight: '1.5',
                                               whiteSpace: 'pre-wrap'
                                           }}>
                                               {brainResponse}
                                           </div>
                                       </div>
                                   )}

                                   {/* Stored Meetings List */}
                                   <div>
                                       <h3 style={{
                                           fontSize: '16px',
                                           fontWeight: '600',
                                           marginBottom: '12px',
                                           color: '#374528'
                                       }}>
                                           Stored Meetings ({storedMeetings.length})
                                       </h3>
                                       
                                       {isLoadingMeetings ? (
                                           <div style={{ textAlign: 'center', padding: '20px' }}>
                                               <div>üîÑ Loading meetings...</div>
                                           </div>
                                       ) : storedMeetings.length === 0 ? (
                                           <div style={{
                                               textAlign: 'center',
                                               padding: '20px',
                                               color: '#6b7280',
                                               fontSize: '14px'
                                           }}>
                                               No meetings stored yet. Generate and save a summary to get started!
                                           </div>
                                       ) : (
                                           <div style={{ maxHeight: '400px', overflowY: 'auto' }}>
                                               {storedMeetings.map((meeting) => (
                                                   <div key={meeting.id} style={{
                                                       padding: '12px',
                                                       backgroundColor: '#f8faf6',
                                                       borderRadius: '8px',
                                                       marginBottom: '8px',
                                                       border: '1px solid #e5e7eb'
                                                   }}>
                                                       <div style={{
                                                           display: 'flex',
                                                           justifyContent: 'space-between',
                                                           alignItems: 'flex-start',
                                                           marginBottom: '8px'
                                                       }}>
                                                           <div>
                                                               <h4 style={{
                                                                   fontSize: '14px',
                                                                   fontWeight: '600',
                                                                   margin: '0 0 4px 0',
                                                                   color: '#374528'
                                                               }}>
                                                                   {meeting.title}
                                                               </h4>
                                                               <div style={{
                                                                   fontSize: '12px',
                                                                   color: '#6b7280'
                                                               }}>
                                                                   üìÖ {meeting.date} {meeting.time && `at ${meeting.time}`}
                                                                   {meeting.venue && ` ‚Ä¢ üìç ${meeting.venue}`}
                                                               </div>
                                                           </div>
                                                           <button
                                                               onClick={() => deleteMeeting(meeting.id)}
                                                               style={{
                                                                   background: 'none',
                                                                   border: 'none',
                                                                   color: '#dc3545',
                                                                   cursor: 'pointer',
                                                                   fontSize: '14px',
                                                                   padding: '4px'
                                                               }}
                                                               title="Delete meeting"
                                                           >
                                                               üóëÔ∏è
                                                           </button>
                                                       </div>
                                                       {(meeting.companyAttendees || meeting.clientAttendees) && (
                                                           <div style={{
                                                               fontSize: '12px',
                                                               color: '#6b7280',
                                                               marginBottom: '8px'
                                                           }}>
                                                               {meeting.companyAttendees && `üë• ${meeting.companyAttendees}`}
                                                               {meeting.companyAttendees && meeting.clientAttendees && ' ‚Ä¢ '}
                                                               {meeting.clientAttendees && `ü§ù ${meeting.clientAttendees}`}
                                                           </div>
                                                       )}
                                                       <div style={{
                                                           fontSize: '12px',
                                                           color: '#374528',
                                                           maxHeight: '60px',
                                                           overflow: 'hidden',
                                                           textOverflow: 'ellipsis'
                                                       }}>
                                                           {meeting.summary.substring(0, 150)}...
                                                       </div>
                                                   </div>
                                               ))}
                                           </div>
                                       )}
                                   </div>
                               </div>
                           )}
                       </div>
                   </main>
               </div>
           );
       }

       ReactDOM.render(<MeetingNotesApp />, document.getElementById('root'));
   </script>
</body>
</html>
