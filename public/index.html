<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meeting Notes AI Assistant</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f8faf6;
            color: #1f2937;
            line-height: 1.6;
        }
        
        .custom-file-input {
            position: relative;
            overflow: hidden;
            display: inline-block;
            cursor: pointer;
        }
        
        .custom-file-input input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .ai-indicator {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 12px;
            color: #6b7c4e;
            margin-left: 8px;
        }

        .ai-indicator.processing {
            color: #f59e0b;
        }

        .error-message {
            background-color: #fef2f2;
            border: 1px solid #fecaca;
            color: #dc2626;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        function MeetingNotesApp() {
            // State management
            const [files, setFiles] = useState([]);
            const [rawNotes, setRawNotes] = useState('');
            const [summary, setSummary] = useState('');
            const [isGenerating, setIsGenerating] = useState(false);
            const [isExtracting, setIsExtracting] = useState(false);
            const [meetingDate, setMeetingDate] = useState('');
            const [meetingTime, setMeetingTime] = useState('');
            const [location, setLocation] = useState('');
            const [meetingTitle, setMeetingTitle] = useState('');
            const [companyAttendees, setCompanyAttendees] = useState('');
            const [clientAttendees, setClientAttendees] = useState('');
            const [aiError, setAiError] = useState('');

            // Brain functionality
            const [storedMeetings, setStoredMeetings] = useState([]);
            const [showBrain, setShowBrain] = useState(false);
            const [brainQuery, setBrainQuery] = useState('');
            const [brainResponse, setBrainResponse] = useState('');
            const [isBrainLoading, setIsBrainLoading] = useState(false);
            const [showSaveSuccess, setShowSaveSuccess] = useState(false);
            const [isLoadingMeetings, setIsLoadingMeetings] = useState(false);
            const [saveError, setSaveError] = useState('');

            // API endpoints
            const API_BASE_URL = 'https://meeting-notes-api-watertrace.vercel.app/api';

            // Load meetings from database on component mount
            useEffect(() => {
                loadMeetingsFromDatabase();
            }, []);

            const loadMeetingsFromDatabase = async () => {
                setIsLoadingMeetings(true);
                try {
                    const response = await fetch(`${API_BASE_URL}/meetings`);
                    if (response.ok) {
                        const meetings = await response.json();
                        const appFormatMeetings = meetings.map(meeting => ({
                            id: meeting.id,
                            date: meeting.meeting_date,
                            time: meeting.meeting_time,
                            venue: meeting.venue,
                            title: meeting.title,
                            companyAttendees: meeting.company_attendees,
                            clientAttendees: meeting.client_attendees,
                            rawNotes: meeting.raw_notes,
                            summary: meeting.summary,
                            createdAt: meeting.created_at
                        }));
                        setStoredMeetings(appFormatMeetings);
                    }
                } catch (error) {
                    console.error('Error loading meetings:', error);
                } finally {
                    setIsLoadingMeetings(false);
                }
            };

            const saveMeetingToDatabase = async (meetingRecord) => {
                try {
                    const response = await fetch(`${API_BASE_URL}/meetings`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            id: meetingRecord.id,
                            title: meetingRecord.title,
                            meeting_date: meetingRecord.date,
                            meeting_time: meetingRecord.time,
                            venue: meetingRecord.venue,
                            company_attendees: meetingRecord.companyAttendees,
                            client_attendees: meetingRecord.clientAttendees,
                            raw_notes: meetingRecord.rawNotes,
                            summary: meetingRecord.summary,
                            created_at: meetingRecord.createdAt
                        })
                    });
                    if (response.ok) {
                        return await response.json();
                    } else {
                        throw new Error(`HTTP ${response.status}`);
                    }
                } catch (error) {
                    throw error;
                }
            };

            const deleteMeetingFromDatabase = async (id) => {
                try {
                    const response = await fetch(`${API_BASE_URL}/meetings?id=${id}`, {
                        method: 'DELETE',
                        headers: { 'Content-Type': 'application/json' }
                    });
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}`);
                    }
                } catch (error) {
                    throw error;
                }
            };

            // AI-powered extraction
            const callAI = async (type, content, prompt = '') => {
                try {
                    const response = await fetch(`${API_BASE_URL}/ai`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            type,
                            content,
                            prompt
                        })
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error || `HTTP ${response.status}`);
                    }

                    const data = await response.json();
                    return data.result;
                } catch (error) {
                    console.error('AI API Error:', error);
                    throw error;
                }
            };

            const handleFileUpload = (event) => {
                const uploadedFiles = Array.from(event.target.files);
                setFiles(prev => [...prev, ...uploadedFiles]);
                
                // Auto-extract immediately when files are uploaded
                setTimeout(() => {
                    extractFromFilesWithAI(uploadedFiles);
                }, 100);
            };

            const removeFile = (index) => {
                setFiles(prev => prev.filter((_, i) => i !== index));
            };

            const extractFromFilesWithAI = async (filesToProcess = files) => {
                if (filesToProcess.length === 0) return;
                
                setIsExtracting(true);
                setAiError('');
                
                try {
                    let extractedContent = '';
                    
                    // Read all files
                    for (const file of filesToProcess) {
                        const text = await readFile(file);
                        extractedContent += `\n\n=== FILE: ${file.name} ===\n${text}`;
                    }
                    
                    setRawNotes(extractedContent);
                    
                    // Use AI to extract meeting details
                    try {
                        const extractedData = await callAI('extract', extractedContent);
                        
                        console.log('AI Extraction Result:', extractedData);
                        
                        // Update form fields with AI-extracted data
                        if (extractedData.title) {
                            setMeetingTitle(extractedData.title);
                        }
                        if (extractedData.date) {
                            setMeetingDate(extractedData.date);
                        }
                        if (extractedData.time) {
                            setMeetingTime(extractedData.time);
                        }
                        if (extractedData.location) {
                            setLocation(extractedData.location);
                        }
                        if (extractedData.attendees) {
                            setCompanyAttendees(extractedData.attendees);
                        }
                        
                    } catch (aiError) {
                        console.error('AI extraction failed:', aiError);
                        setAiError(`AI extraction failed: ${aiError.message}. You can still fill in the details manually.`);
                        
                        // Fallback to basic filename extraction
                        if (filesToProcess.length > 0) {
                            const firstFile = filesToProcess[0];
                            const basicTitle = firstFile.name.replace(/\.[^/.]+$/, '').replace(/[-_]/g, ' ');
                            setMeetingTitle(basicTitle);
                        }
                    }
                    
                } catch (error) {
                    console.error('Error processing files:', error);
                    setAiError(`File processing failed: ${error.message}`);
                } finally {
                    setIsExtracting(false);
                }
            };

            const readFile = (file) => {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = (e) => resolve(e.target.result);
                    reader.onerror = reject;
                    reader.readAsText(file);
                });
            };

            const generateSummaryWithAI = async () => {
                if (!rawNotes.trim()) return;
                
                setIsGenerating(true);
                setAiError('');
                
                try {
                    // Create context for AI
                    const meetingContext = {
                        title: meetingTitle || 'Meeting',
                        date: meetingDate,
                        time: meetingTime,
                        location: location,
                        companyAttendees: companyAttendees,
                        clientAttendees: clientAttendees,
                        content: rawNotes
                    };
                    
                    const contextString = `Meeting: ${meetingContext.title}
Date: ${meetingContext.date || 'Not specified'}
Time: ${meetingContext.time || 'Not specified'}
Location: ${meetingContext.location || 'Not specified'}
Company Attendees: ${meetingContext.companyAttendees || 'Not specified'}
Client Attendees: ${meetingContext.clientAttendees || 'Not specified'}

Meeting Content:
${meetingContext.content}`;
                    
                    const generatedSummary = await callAI('summarize', contextString);
                    setSummary(generatedSummary);
                    
                } catch (error) {
                    console.error('AI summary generation failed:', error);
                    setAiError(`Summary generation failed: ${error.message}. Please try again or create a manual summary.`);
                } finally {
                    setIsGenerating(false);
                }
            };

            const saveToBrain = async () => {
                if (!summary.trim()) return;
                setSaveError('');
                
                const meetingRecord = {
                    id: Date.now(),
                    date: meetingDate || new Date().toISOString().split('T')[0],
                    time: meetingTime || '',
                    venue: location || '',
                    title: meetingTitle || 'Untitled Meeting',
                    companyAttendees: companyAttendees || '',
                    clientAttendees: clientAttendees || '',
                    rawNotes: rawNotes,
                    summary: summary,
                    createdAt: new Date().toISOString()
                };
                
                try {
                    const savedMeeting = await saveMeetingToDatabase(meetingRecord);
                    const appFormatMeeting = {
                        id: savedMeeting.id,
                        date: savedMeeting.meeting_date,
                        time: savedMeeting.meeting_time,
                        venue: savedMeeting.venue,
                        title: savedMeeting.title,
                        companyAttendees: savedMeeting.company_attendees,
                        clientAttendees: savedMeeting.client_attendees,
                        rawNotes: savedMeeting.raw_notes,
                        summary: savedMeeting.summary,
                        createdAt: savedMeeting.created_at
                    };
                    
                    setStoredMeetings(prev => [appFormatMeeting, ...prev]);
                    setShowSaveSuccess(true);
                    setTimeout(() => setShowSaveSuccess(false), 3000);
                } catch (error) {
                    setSaveError('Failed to save meeting to database. Please try again.');
                    setTimeout(() => setSaveError(''), 5000);
                }
            };

            const deleteMeeting = async (id) => {
                try {
                    await deleteMeetingFromDatabase(id);
                    setStoredMeetings(prev => prev.filter(meeting => meeting.id !== id));
                } catch (error) {
                    setSaveError('Failed to delete meeting. Please try again.');
                    setTimeout(() => setSaveError(''), 5000);
                }
            };

            const handleBrainQueryWithAI = async () => {
                if (!brainQuery.trim() || storedMeetings.length === 0) return;

                setIsBrainLoading(true);
                setBrainResponse('');

                try {
                    // Get fresh data from database
                    const response = await fetch(`${API_BASE_URL}/meetings`);
                    let meetingsForQuery = storedMeetings;
                    
                    if (response.ok) {
                        const latestMeetings = await response.json();
                        meetingsForQuery = latestMeetings.map(meeting => ({
                            id: meeting.id,
                            date: meeting.meeting_date,
                            time: meeting.meeting_time,
                            venue: meeting.venue,
                            title: meeting.title,
                            companyAttendees: meeting.company_attendees,
                            clientAttendees: meeting.client_attendees,
                            rawNotes: meeting.raw_notes,
                            summary: meeting.summary,
                            createdAt: meeting.created_at
                        }));
                    }

                    // Prepare meeting data for AI
                    const meetingData = meetingsForQuery.map(meeting => 
                        `Meeting: ${meeting.title} (${meeting.date})
Location: ${meeting.venue || 'Not specified'}
Attendees: ${meeting.companyAttendees || ''} ${meeting.clientAttendees || ''}
Summary: ${meeting.summary}
---`
                    ).join('\n\n');

                    const queryContext = `You have access to ${meetingsForQuery.length} stored meetings. Here's the data:

${meetingData}

User Question: ${brainQuery}`;

                    const aiResponse = await callAI('query', queryContext);
                    setBrainResponse(aiResponse);
                    
                } catch (error) {
                    console.error('Brain query failed:', error);
                    setBrainResponse(`Sorry, I couldn't process your query: ${error.message}. Please try again with a different question.`);
                } finally {
                    setIsBrainLoading(false);
                }
            };

            return (
                <div style={{
                    fontFamily: 'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                    backgroundColor: '#f8faf6',
                    minHeight: '100vh',
                    padding: '20px'
                }}>
                    <header style={{
                        maxWidth: '1200px',
                        margin: '0 auto',
                        marginBottom: '32px'
                    }}>
                        <div style={{
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'center',
                            marginBottom: '20px'
                        }}>
                            <div>
                                <h1 style={{
                                    fontSize: '32px',
                                    fontWeight: '700',
                                    color: '#374528',
                                    margin: '0'
                                }}>
                                    Meeting Notes AI Assistant
                                </h1>
                                <div className="ai-indicator">
                                    ü§ñ Powered by Google Gemini AI
                                </div>
                            </div>
                            
                            <button
                                onClick={() => setShowBrain(!showBrain)}
                                style={{
                                    padding: '12px 20px',
                                    borderRadius: '8px',
                                    border: '2px solid #374528',
                                    backgroundColor: showBrain ? '#374528' : 'transparent',
                                    color: showBrain ? 'white' : '#374528',
                                    fontSize: '16px',
                                    fontWeight: '600',
                                    cursor: 'pointer',
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '8px'
                                }}
                            >
                                üß† Brain ({storedMeetings.length})
                            </button>
                        </div>
                    </header>

                    <main style={{
                        maxWidth: '1200px',
                        margin: '0 auto'
                    }}>
                        {/* Summary and Brain Grid */}
                        <div style={{
                            display: 'grid',
                            gridTemplateColumns: showBrain ? '2fr 1fr' : '1fr',
                            gap: '24px'
                        }}>
                            {/* Summary Section */}
                            {summary && (
                                <section style={{
                                    backgroundColor: 'white',
                                    borderRadius: '12px',
                                    padding: '24px',
                                    boxShadow: '0 1px 3px rgba(0,0,0,0.1)'
                                }}>
                                    <div style={{
                                        display: 'flex',
                                        justifyContent: 'space-between',
                                        alignItems: 'center',
                                        marginBottom: '16px'
                                    }}>
                                        <h2 style={{
                                            fontSize: '20px',
                                            fontWeight: '600',
                                            color: '#374528',
                                            margin: '0'
                                        }}>
                                            üìã AI-Generated Summary
                                            <span className="ai-indicator">
                                                ü§ñ Powered by AI
                                            </span>
                                        </h2>
                                        <button
                                            onClick={saveToBrain}
                                            disabled={!summary.trim()}
                                            style={{
                                                padding: '8px 16px',
                                                backgroundColor: summary.trim() ? '#6b7c4e' : '#9ca3af',
                                                color: 'white',
                                                border: 'none',
                                                borderRadius: '6px',
                                                cursor: summary.trim() ? 'pointer' : 'not-allowed',
                                                fontSize: '14px',
                                                fontWeight: '500'
                                            }}
                                        >
                                            üß† Save to Brain
                                        </button>
                                    </div>
                                    <div style={{
                                        padding: '16px',
                                        backgroundColor: '#f8faf6',
                                        borderRadius: '8px',
                                        border: '1px solid #e5e7eb',
                                        whiteSpace: 'pre-wrap',
                                        fontSize: '14px',
                                        lineHeight: '1.6',
                                        maxHeight: '600px',
                                        overflowY: 'auto'
                                    }}>
                                        {summary}
                                    </div>
                                </section>
                            )}

                            {/* Brain Panel */}
                            {showBrain && (
                                <div style={{
                                    backgroundColor: 'white',
                                    borderRadius: '12px',
                                    padding: '24px',
                                    boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                                    height: 'fit-content'
                                }}>
                                    <h2 style={{ 
                                        fontSize: '20px', 
                                        fontWeight: '600', 
                                        marginBottom: '16px',
                                        color: '#374528',
                                        display: 'flex',
                                        alignItems: 'center',
                                        gap: '8px'
                                    }}>
                                        üß† AI Meeting Brain
                                        <span className="ai-indicator">
                                            ü§ñ AI Powered
                                        </span>
                                    </h2>

                                    {/* Query Section */}
                                    <div style={{ marginBottom: '20px' }}>
                                        <label style={{
                                            display: 'block',
                                            marginBottom: '8px',
                                            fontSize: '14px',
                                            fontWeight: '500',
                                            color: '#374528'
                                        }}>
                                            Ask AI about your meetings:
                                        </label>
                                        <div style={{ display: 'flex', gap: '8px' }}>
                                            <input
                                                type="text"
                                                value={brainQuery}
                                                onChange={(e) => setBrainQuery(e.target.value)}
                                                placeholder="e.g., What were the main action items from the training meeting?"
                                                onKeyPress={(e) => e.key === 'Enter' && handleBrainQueryWithAI()}
                                                style={{
                                                    flex: 1,
                                                    padding: '8px 12px',
                                                    border: '1px solid #d1d5db',
                                                    borderRadius: '6px',
                                                    fontSize: '14px'
                                                }}
                                            />
                                            <button
                                                onClick={handleBrainQueryWithAI}
                                                disabled={!brainQuery.trim() || storedMeetings.length === 0 || isBrainLoading}
                                                style={{
                                                    padding: '8px 16px',
                                                    backgroundColor: (brainQuery.trim() && storedMeetings.length > 0) ? '#6b7c4e' : '#9ca3af',
                                                    color: 'white',
                                                    border: 'none',
                                                    borderRadius: '6px',
                                                    cursor: (brainQuery.trim() && storedMeetings.length > 0) ? 'pointer' : 'not-allowed',
                                                    fontSize: '14px',
                                                    fontWeight: '500'
                                                }}
                                            >
                                                {isBrainLoading ? 'ü§ñ' : 'üîç'}
                                            </button>
                                        </div>
                                        {storedMeetings.length === 0 && (
                                            <p style={{
                                                fontSize: '12px',
                                                color: '#6b7280',
                                                marginTop: '4px'
                                            }}>
                                                Save some meetings to start querying your Brain!
                                            </p>
                                        )}
                                    </div>

                                    {/* Response Section */}
                                    {brainResponse && (
                                        <div style={{
                                            padding: '12px',
                                            backgroundColor: '#f8faf6',
                                            borderRadius: '8px',
                                            marginBottom: '20px',
                                            border: '1px solid #e5e7eb'
                                        }}>
                                            <h4 style={{
                                                fontSize: '14px',
                                                fontWeight: '600',
                                                marginBottom: '8px',
                                                color: '#374528',
                                                display: 'flex',
                                                alignItems: 'center',
                                                gap: '4px'
                                            }}>
                                                ü§ñ AI Response:
                                            </h4>
                                            <div style={{
                                                fontSize: '14px',
                                                lineHeight: '1.5',
                                                whiteSpace: 'pre-wrap'
                                            }}>
                                                {brainResponse}
                                            </div>
                                        </div>
                                    )}

                                    {/* Stored Meetings List */}
                                    <div>
                                        <h3 style={{
                                            fontSize: '16px',
                                            fontWeight: '600',
                                            marginBottom: '12px',
                                            color: '#374528'
                                        }}>
                                            Stored Meetings ({storedMeetings.length})
                                        </h3>
                                        
                                        {isLoadingMeetings ? (
                                            <div style={{ textAlign: 'center', padding: '20px' }}>
                                                <div>üîÑ Loading meetings...</div>
                                            </div>
                                        ) : storedMeetings.length === 0 ? (
                                            <div style={{
                                                textAlign: 'center',
                                                padding: '20px',
                                                color: '#6b7280',
                                                fontSize: '14px'
                                            }}>
                                                No meetings stored yet. Upload files and generate AI summaries to get started!
                                            </div>
                                        ) : (
                                            <div style={{ maxHeight: '400px', overflowY: 'auto' }}>
                                                {storedMeetings.map((meeting) => (
                                                    <div key={meeting.id} style={{
                                                        padding: '12px',
                                                        backgroundColor: '#f8faf6',
                                                        borderRadius: '8px',
                                                        marginBottom: '8px',
                                                        border: '1px solid #e5e7eb'
                                                    }}>
                                                        <div style={{
                                                            display: 'flex',
                                                            justifyContent: 'space-between',
                                                            alignItems: 'flex-start',
                                                            marginBottom: '8px'
                                                        }}>
                                                            <div>
                                                                <h4 style={{
                                                                    fontSize: '14px',
                                                                    fontWeight: '600',
                                                                    margin: '0 0 4px 0',
                                                                    color: '#374528'
                                                                }}>
                                                                    {meeting.title}
                                                                </h4>
                                                                <div style={{
                                                                    fontSize: '12px',
                                                                    color: '#6b7280'
                                                                }}>
                                                                    üìÖ {meeting.date} {meeting.time && `at ${meeting.time}`}
                                                                    {meeting.venue && ` ‚Ä¢ üìç ${meeting.venue}`}
                                                                </div>
                                                            </div>
                                                            <button
                                                                onClick={() => deleteMeeting(meeting.id)}
                                                                style={{
                                                                    background: 'none',
                                                                    border: 'none',
                                                                    color: '#dc3545',
                                                                    cursor: 'pointer',
                                                                    fontSize: '14px',
                                                                    padding: '4px'
                                                                }}
                                                                title="Delete meeting"
                                                            >
                                                                üóëÔ∏è
                                                            </button>
                                                        </div>
                                                        {(meeting.companyAttendees || meeting.clientAttendees) && (
                                                            <div style={{
                                                                fontSize: '12px',
                                                                color: '#6b7280',
                                                                marginBottom: '8px'
                                                            }}>
                                                                {meeting.companyAttendees && `üë• ${meeting.companyAttendees}`}
                                                                {meeting.companyAttendees && meeting.clientAttendees && ' ‚Ä¢ '}
                                                                {meeting.clientAttendees && `ü§ù ${meeting.clientAttendees}`}
                                                            </div>
                                                        )}
                                                        <div style={{
                                                            fontSize: '12px',
                                                            color: '#374528',
                                                            maxHeight: '60px',
                                                            overflow: 'hidden',
                                                            textOverflow: 'ellipsis'
                                                        }}>
                                                            {meeting.summary.substring(0, 150)}...
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                </div>
                            )}
                        </div>
                    </main>
                </div>
            );
        }

        ReactDOM.render(<MeetingNotesApp />, document.getElementById('root'));
    </script>
</body>
</html>/* Success/Error Messages */}
                        {showSaveSuccess && (
                            <div style={{
                                backgroundColor: '#d4edda',
                                border: '1px solid #c3e6cb',
                                borderRadius: '8px',
                                padding: '12px',
                                marginBottom: '20px',
                                color: '#155724'
                            }}>
                                ‚úÖ Meeting saved to Brain successfully!
                            </div>
                        )}

                        {saveError && (
                            <div className="error-message">
                                ‚ùå {saveError}
                            </div>
                        )}

                        {aiError && (
                            <div className="error-message">
                                ‚ö†Ô∏è {aiError}
                            </div>
                        )}

                        {/* TOP GRID: File Upload + Raw Notes */}
                        <div style={{
                            display: 'grid',
                            gridTemplateColumns: '1fr 2fr',
                            gap: '24px',
                            marginBottom: '24px'
                        }}>
                            {/* File Upload Section */}
                            <section style={{
                                backgroundColor: 'white',
                                borderRadius: '12px',
                                padding: '24px',
                                boxShadow: '0 1px 3px rgba(0,0,0,0.1)'
                            }}>
                                <h2 style={{
                                    fontSize: '20px',
                                    fontWeight: '600',
                                    marginBottom: '16px',
                                    color: '#374528'
                                }}>
                                    üìÅ Upload Meeting Files
                                    {isExtracting && (
                                        <span className="ai-indicator processing">
                                            ü§ñ AI Extracting...
                                        </span>
                                    )}
                                </h2>
                                
                                <div className="custom-file-input">
                                    <input
                                        type="file"
                                        multiple
                                        accept=".txt,.docx,.pdf,.md"
                                        onChange={handleFileUpload}
                                        id="file-upload"
                                        disabled={isExtracting}
                                    />
                                    <label htmlFor="file-upload" style={{
                                        display: 'inline-block',
                                        padding: '12px 24px',
                                        backgroundColor: isExtracting ? '#9ca3af' : '#6b7c4e',
                                        color: 'white',
                                        borderRadius: '8px',
                                        cursor: isExtracting ? 'not-allowed' : 'pointer',
                                        fontSize: '14px',
                                        fontWeight: '500'
                                    }}>
                                        {isExtracting ? 'Processing...' : 'Choose Files'}
                                    </label>
                                </div>

                                {files.length > 0 && (
                                    <div style={{ marginTop: '16px' }}>
                                        <h3 style={{
                                            fontSize: '16px',
                                            fontWeight: '500',
                                            marginBottom: '8px',
                                            color: '#374528'
                                        }}>
                                            Uploaded Files:
                                        </h3>
                                        <div>
                                            {files.map((file, index) => (
                                                <div key={index} style={{
                                                    display: 'flex',
                                                    justifyContent: 'space-between',
                                                    alignItems: 'center',
                                                    padding: '8px 12px',
                                                    backgroundColor: '#f8faf6',
                                                    borderRadius: '6px',
                                                    marginBottom: '8px'
                                                }}>
                                                    <span style={{ fontSize: '14px', color: '#374528' }}>
                                                        {file.name}
                                                    </span>
                                                    <button
                                                        onClick={() => removeFile(index)}
                                                        style={{
                                                            background: 'none',
                                                            border: 'none',
                                                            color: '#dc3545',
                                                            cursor: 'pointer',
                                                            fontSize: '16px'
                                                        }}
                                                    >
                                                        ‚úï
                                                    </button>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </section>

                            {/* Raw Notes Section */}
                            <section style={{
                                backgroundColor: 'white',
                                borderRadius: '12px',
                                padding: '24px',
                                boxShadow: '0 1px 3px rgba(0,0,0,0.1)'
                            }}>
                                <h2 style={{
                                    fontSize: '20px',
                                    fontWeight: '600',
                                    marginBottom: '16px',
                                    color: '#374528'
                                }}>
                                    üìù Meeting Notes
                                </h2>
                                <textarea
                                    value={rawNotes}
                                    onChange={(e) => setRawNotes(e.target.value)}
                                    placeholder="Paste your meeting notes here or upload files for AI extraction..."
                                    style={{
                                        width: '100%',
                                        height: '300px',
                                        padding: '12px',
                                        border: '1px solid #d1d5db',
                                        borderRadius: '8px',
                                        fontSize: '14px',
                                        lineHeight: '1.5',
                                        resize: 'vertical',
                                        fontFamily: 'inherit'
                                    }}
                                />
                            </section>
                        </div>

                        {/* Meeting Details Section */}
                        <section style={{
                            backgroundColor: 'white',
                            borderRadius: '12px',
                            padding: '24px',
                            boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                            marginBottom: '24px'
                        }}>
                            <h2 style={{
                                fontSize: '20px',
                                fontWeight: '600',
                                marginBottom: '16px',
                                color: '#374528'
                            }}>
                                üìÖ Meeting Details
                                {(meetingTitle || meetingDate || meetingTime || location || companyAttendees) && (
                                    <span className="ai-indicator">
                                        ü§ñ AI Extracted
                                    </span>
                                )}
                            </h2>
                            
                            <div style={{
                                display: 'grid',
                                gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                                gap: '16px'
                            }}>
                                <div>
                                    <label style={{
                                        display: 'block',
                                        marginBottom: '4px',
                                        fontSize: '14px',
                                        fontWeight: '500',
                                        color: '#374528'
                                    }}>
                                        Meeting Title
                                    </label>
                                    <input
                                        type="text"
                                        value={meetingTitle}
                                        onChange={(e) => setMeetingTitle(e.target.value)}
                                        placeholder="Enter meeting title"
                                        style={{
                                            width: '100%',
                                            padding: '8px 12px',
                                            border: '1px solid #d1d5db',
                                            borderRadius: '6px',
                                            fontSize: '14px'
                                        }}
                                    />
                                </div>
                                
                                <div>
                                    <label style={{
                                        display: 'block',
                                        marginBottom: '4px',
                                        fontSize: '14px',
                                        fontWeight: '500',
                                        color: '#374528'
                                    }}>
                                        Date
                                    </label>
                                    <input
                                        type="date"
                                        value={meetingDate}
                                        onChange={(e) => setMeetingDate(e.target.value)}
                                        style={{
                                            width: '100%',
                                            padding: '8px 12px',
                                            border: '1px solid #d1d5db',
                                            borderRadius: '6px',
                                            fontSize: '14px'
                                        }}
                                    />
                                </div>
                                
                                <div>
                                    <label style={{
                                        display: 'block',
                                        marginBottom: '4px',
                                        fontSize: '14px',
                                        fontWeight: '500',
                                        color: '#374528'
                                    }}>
                                        Time
                                    </label>
                                    <input
                                        type="time"
                                        value={meetingTime}
                                        onChange={(e) => setMeetingTime(e.target.value)}
                                        style={{
                                            width: '100%',
                                            padding: '8px 12px',
                                            border: '1px solid #d1d5db',
                                            borderRadius: '6px',
                                            fontSize: '14px'
                                        }}
                                    />
                                </div>
                                
                                <div>
                                    <label style={{
                                        display: 'block',
                                        marginBottom: '4px',
                                        fontSize: '14px',
                                        fontWeight: '500',
                                        color: '#374528'
                                    }}>
                                        Location
                                    </label>
                                    <input
                                        type="text"
                                        value={location}
                                        onChange={(e) => setLocation(e.target.value)}
                                        placeholder="Meeting location"
                                        style={{
                                            width: '100%',
                                            padding: '8px 12px',
                                            border: '1px solid #d1d5db',
                                            borderRadius: '6px',
                                            fontSize: '14px'
                                        }}
                                    />
                                </div>
                                
                                <div>
                                    <label style={{
                                        display: 'block',
                                        marginBottom: '4px',
                                        fontSize: '14px',
                                        fontWeight: '500',
                                        color: '#374528'
                                    }}>
                                        Company Attendees
                                    </label>
                                    <input
                                        type="text"
                                        value={companyAttendees}
                                        onChange={(e) => setCompanyAttendees(e.target.value)}
                                        placeholder="Company attendees"
                                        style={{
                                            width: '100%',
                                            padding: '8px 12px',
                                            border: '1px solid #d1d5db',
                                            borderRadius: '6px',
                                            fontSize: '14px'
                                        }}
                                    />
                                </div>
                                
                                <div>
                                    <label style={{
                                        display: 'block',
                                        marginBottom: '4px',
                                        fontSize: '14px',
                                        fontWeight: '500',
                                        color: '#374528'
                                    }}>
                                        Client Attendees
                                    </label>
                                    <input
                                        type="text"
                                        value={clientAttendees}
                                        onChange={(e) => setClientAttendees(e.target.value)}
                                        placeholder="Client attendees"
                                        style={{
                                            width: '100%',
                                            padding: '8px 12px',
                                            border: '1px solid #d1d5db',
                                            borderRadius: '6px',
                                            fontSize: '14px'
                                        }}
                                    />
                                </div>
                            </div>
                            
                            <button
                                onClick={generateSummaryWithAI}
                                disabled={!rawNotes.trim() || isGenerating}
                                style={{
                                    marginTop: '20px',
                                    padding: '12px 24px',
                                    backgroundColor: rawNotes.trim() ? '#6b7c4e' : '#9ca3af',
                                    color: 'white',
                                    border: 'none',
                                    borderRadius: '8px',
                                    cursor: rawNotes.trim() && !isGenerating ? 'pointer' : 'not-allowed',
                                    fontSize: '14px',
                                    fontWeight: '500',
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '8px'
                                }}
                            >
                                {isGenerating ? (
                                    <>ü§ñ AI Generating Summary...</>
                                ) : (
                                    <>ü§ñ Generate AI Summary</>
                                )}
                            </button>
                        </section>

                        {/* Summary and Brain Grid */}
                        <div style={{
                            display: 'grid',
                            gridTemplateColumns: showBrain ? '2fr 1fr' : '1fr',
                            gap: '24px'
                        }}>
                            {/* Summary Section */}
                            {summary && (
                                <section style={{
                                    backgroundColor: 'white',
                                    borderRadius: '12px',
                                    padding: '24px',
                                    boxShadow: '0 1px 3px rgba(0,0,0,0.1)'
                                }}>
                                    <div style={{
                                        display: 'flex',
                                        justifyContent: 'space-between',
                                        alignItems: 'center',
                                        marginBottom: '16px'
                                    }}>
                                        <h2 style={{
                                            fontSize: '20px',
                                            fontWeight: '600',
                                            color: '#374528',
                                            margin: '0',
                                            display: 'flex',
                                            alignItems: 'center',
                                            gap: '8px'
                                        }}>
                                            üìã AI-Generated Summary
                                            <span className="ai-indicator">
                                                ü§ñ Generated by AI
                                            </span>
                                        </h2>
                                        <button
                                            onClick={saveToBrain}
                                            disabled={!summary.trim()}
                                            style={{
                                                padding: '8px 16px',
                                                backgroundColor: summary.trim() ? '#6b7c4e' : '#9ca3af',
                                                color: 'white',
                                                border: 'none',
                                                borderRadius: '6px',
                                                cursor: summary.trim() ? 'pointer' : 'not-allowed',
                                                fontSize: '14px',
                                                fontWeight: '500'
                                            }}
                                        >
                                            üß† Save to Brain
                                        </button>
                                    </div>
                                    <div style={{
                                        padding: '16px',
                                        backgroundColor: '#f8faf6',
                                        borderRadius: '8px',
                                        border: '1px solid #e5e7eb',
                                        whiteSpace: 'pre-wrap',
                                        fontSize: '14px',
                                        lineHeight: '1.6',
                                        maxHeight: '600px',
                                        overflowY: 'auto'
                                    }}>
                                        {summary}
                                    </div>
                                </section>
                            )}

                            {/* Brain Panel */}
                            {showBrain && (
                                <div style={{
                                    backgroundColor: 'white',
                                    borderRadius: '12px',
                                    padding: '24px',
                                    boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                                    height: 'fit-content'
                                }}>
                                    <h2 style={{ 
                                        fontSize: '20px', 
                                        fontWeight: '600', 
                                        marginBottom: '16px',
                                        color: '#374528',
                                        display: 'flex',
                                        alignItems: 'center',
                                        gap: '8px'
                                    }}>
                                        üß† AI Meeting Brain
                                        <span className="ai-indicator">
                                            ü§ñ AI Powered
                                        </span>
                                    </h2>

                                    {/* Query Section */}
                                    <div style={{ marginBottom: '20px' }}>
                                        <label style={{
                                            display: 'block',
                                            marginBottom: '8px',
                                            fontSize: '14px',
                                            fontWeight: '500',
                                            color: '#374528'
                                        }}>
                                            Ask AI about your meetings:
                                        </label>
                                        <div style={{ display: 'flex', gap: '8px' }}>
                                            <input
                                                type="text"
                                                value={brainQuery}
                                                onChange={(e) => setBrainQuery(e.target.value)}
                                                placeholder="e.g., What training was discussed? Who attended the June meeting?"
                                                onKeyPress={(e) => e.key === 'Enter' && handleBrainQueryWithAI()}
                                                style={{
                                                    flex: 1,
                                                    padding: '8px 12px',
                                                    border: '1px solid #d1d5db',
                                                    borderRadius: '6px',
                                                    fontSize: '14px'
                                                }}
                                            />
                                            <button
                                                onClick={handleBrainQueryWithAI}
                                                disabled={!brainQuery.trim() || storedMeetings.length === 0 || isBrainLoading}
                                                style={{
                                                    padding: '8px 16px',
                                                    backgroundColor: (brainQuery.trim() && storedMeetings.length > 0) ? '#6b7c4e' : '#9ca3af',
                                                    color: 'white',
                                                    border: 'none',
                                                    borderRadius: '6px',
                                                    cursor: (brainQuery.trim() && storedMeetings.length > 0) ? 'pointer' : 'not-allowed',
                                                    fontSize: '14px',
                                                    fontWeight: '500'
                                                }}
                                            >
                                                {isBrainLoading ? 'ü§ñ' : 'üîç'}
                                            </button>
                                        </div>
                                        
                                        {/* Quick query suggestions */}
                                        {storedMeetings.length > 0 && (
                                            <div style={{ marginTop: '8px' }}>
                                                <div style={{ fontSize: '12px', color: '#6b7280', marginBottom: '4px' }}>
                                                    Quick questions:
                                                </div>
                                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '4px' }}>
                                                    {[
                                                        'What action items were discussed?',
                                                        'Who attended the meetings?',
                                                        'What decisions were made?',
                                                        'What are the next steps?'
                                                    ].map((suggestion, index) => (
                                                        <button
                                                            key={index}
                                                            onClick={() => setBrainQuery(suggestion)}
                                                            style={{
                                                                padding: '4px 8px',
                                                                fontSize: '11px',
                                                                backgroundColor: '#f3f4f6',
                                                                border: '1px solid #e5e7eb',
                                                                borderRadius: '4px',
                                                                cursor: 'pointer',
                                                                color: '#374528'
                                                            }}
                                                        >
                                                            {suggestion}
                                                        </button>
                                                    ))}
                                                </div>
                                            </div>
                                        )}
                                    </div>

                                    {/* Response Section */}
                                    {brainResponse && (
                                        <div style={{
                                            padding: '12px',
                                            backgroundColor: '#f8faf6',
                                            borderRadius: '8px',
                                            marginBottom: '20px',
                                            border: '1px solid #e5e7eb'
                                        }}>
                                            <h4 style={{
                                                fontSize: '14px',
                                                fontWeight: '600',
                                                marginBottom: '8px',
                                                color: '#374528',
                                                display: 'flex',
                                                alignItems: 'center',
                                                gap: '4px'
                                            }}>
                                                ü§ñ AI Response:
                                            </h4>
                                            <div style={{
                                                fontSize: '14px',
                                                lineHeight: '1.5',
                                                whiteSpace: 'pre-wrap'
                                            }}>
                                                {brainResponse}
                                            </div>
                                        </div>
                                    )}

                                    {isBrainLoading && (
                                        <div style={{
                                            padding: '20px',
                                            textAlign: 'center',
                                            color: '#6b7280',
                                            backgroundColor: '#f8faf6',
                                            borderRadius: '8px',
                                            marginBottom: '20px'
                                        }}>
                                            ü§ñ AI is analyzing your meetings...
                                        </div>
                                    )}

                                    {/* Stored Meetings List */}
                                    <div>
                                        <h3 style={{
                                            fontSize: '16px',
                                            fontWeight: '600',
                                            marginBottom: '12px',
                                            color: '#374528'
                                        }}>
                                            Stored Meetings ({storedMeetings.length})
                                        </h3>
                                        
                                        {isLoadingMeetings ? (
                                            <div style={{ textAlign: 'center', padding: '20px' }}>
                                                <div>üîÑ Loading meetings...</div>
                                            </div>
                                        ) : storedMeetings.length === 0 ? (
                                            <div style={{
                                                textAlign: 'center',
                                                padding: '20px',
                                                color: '#6b7280',
                                                fontSize: '14px'
                                            }}>
                                                No meetings stored yet. Generate and save an AI summary to get started!
                                            </div>
                                        ) : (
                                            <div style={{ maxHeight: '400px', overflowY: 'auto' }}>
                                                {storedMeetings.map((meeting) => (
                                                    <div key={meeting.id} style={{
                                                        padding: '12px',
                                                        backgroundColor: '#f8faf6',
                                                        borderRadius: '8px',
                                                        marginBottom: '8px',
                                                        border: '1px solid #e5e7eb'
                                                    }}>
                                                        <div style={{
                                                            display: 'flex',
                                                            justifyContent: 'space-between',
                                                            alignItems: 'flex-start',
                                                            marginBottom: '8px'
                                                        }}>
                                                            <div>
                                                                <h4 style={{
                                                                    fontSize: '14px',
                                                                    fontWeight: '600',
                                                                    margin: '0 0 4px 0',
                                                                    color: '#374528'
                                                                }}>
                                                                    {meeting.title}
                                                                </h4>
                                                                <div style={{
                                                                    fontSize: '12px',
                                                                    color: '#6b7280'
                                                                }}>
                                                                    üìÖ {meeting.date} {meeting.time && `at ${meeting.time}`}
                                                                    {meeting.venue && ` ‚Ä¢ üìç ${meeting.venue}`}
                                                                </div>
                                                            </div>
                                                            <button
                                                                onClick={() => deleteMeeting(meeting.id)}
                                                                style={{
                                                                    background: 'none',
                                                                    border: 'none',
                                                                    color: '#dc3545',
                                                                    cursor: 'pointer',
                                                                    fontSize: '14px',
                                                                    padding: '4px'
                                                                }}
                                                                title="Delete meeting"
                                                            >
                                                                üóëÔ∏è
                                                            </button>
                                                        </div>
                                                        {(meeting.companyAttendees || meeting.clientAttendees) && (
                                                            <div style={{
                                                                fontSize: '12px',
                                                                color: '#6b7280',
                                                                marginBottom: '8px'
                                                            }}>
                                                                {meeting.companyAttendees && `üë• ${meeting.companyAttendees}`}
                                                                {meeting.companyAttendees && meeting.clientAttendees && ' ‚Ä¢ '}
                                                                {meeting.clientAttendees && `ü§ù ${meeting.clientAttendees}`}
                                                            </div>
                                                        )}
                                                        <div style={{
                                                            fontSize: '12px',
                                                            color: '#374528',
                                                            maxHeight: '60px',
                                                            overflow: 'hidden',
                                                            textOverflow: 'ellipsis'
                                                        }}>
                                                            {meeting.summary.substring(0, 150)}...
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                </div>
                            )}
                        </div>
                    </main>
                </div>
            );
        }

        ReactDOM.render(<MeetingNotesApp />, document.getElementById('root'));
    </script>
</body>
</html>
