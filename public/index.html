<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meeting Notes AI Assistant</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .custom-file-input {
            position: relative;
            overflow: hidden;
            display: inline-block;
            cursor: pointer;
        }
        .custom-file-input input[type=file] {
            position: absolute;
            left: -9999px;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        function MeetingNotesApp() {
            // State management
            const [files, setFiles] = useState([]);
            const [rawNotes, setRawNotes] = useState('');
            const [summary, setSummary] = useState('');
            const [isGenerating, setIsGenerating] = useState(false);
            const [meetingDate, setMeetingDate] = useState('');
            const [meetingTime, setMeetingTime] = useState('');
            const [location, setLocation] = useState('');
            const [meetingTitle, setMeetingTitle] = useState('');
            const [companyAttendees, setCompanyAttendees] = useState('');
            const [clientAttendees, setClientAttendees] = useState('');

            // Brain functionality for storing and querying meetings
            const [storedMeetings, setStoredMeetings] = useState([]);
            const [showBrain, setShowBrain] = useState(false);
            const [brainQuery, setBrainQuery] = useState('');
            const [brainResponse, setBrainResponse] = useState('');
            const [isBrainLoading, setIsBrainLoading] = useState(false);
            const [showSaveSuccess, setShowSaveSuccess] = useState(false);
            const [isLoadingMeetings, setIsLoadingMeetings] = useState(false);
            const [saveError, setSaveError] = useState('');

            // Your Vercel API endpoint
            const API_BASE_URL = 'https://meeting-notes-api-watertrace.vercel.app/api';

            // Load meetings from database on component mount
            useEffect(() => {
                loadMeetingsFromDatabase();
            }, []);

            const loadMeetingsFromDatabase = async () => {
                setIsLoadingMeetings(true);
                try {
                    console.log('Loading meetings from API...');
                    const response = await fetch(`${API_BASE_URL}/meetings`, {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });

                    console.log('Load response status:', response.status);
                    
                    if (response.ok) {
                        const meetings = await response.json();
                        console.log('Loaded meetings:', meetings);
                        
                        // Convert database format to app format
                        const appFormatMeetings = meetings.map(meeting => ({
                            id: meeting.id,
                            date: meeting.meeting_date,
                            time: meeting.meeting_time,
                            venue: meeting.venue,
                            title: meeting.title,
                            companyAttendees: meeting.company_attendees,
                            clientAttendees: meeting.client_attendees,
                            rawNotes: meeting.raw_notes,
                            summary: meeting.summary,
                            createdAt: meeting.created_at
                        }));
                        
                        setStoredMeetings(appFormatMeetings);
                    } else {
                        const errorText = await response.text();
                        console.error('Failed to load meetings:', response.status, errorText);
                    }
                } catch (error) {
                    console.error('Error loading meetings:', error);
                } finally {
                    setIsLoadingMeetings(false);
                }
            };

            const saveMeetingToDatabase = async (meetingRecord) => {
                try {
                    console.log('Saving meeting via API...');
                    const response = await fetch(`${API_BASE_URL}/meetings`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            id: meetingRecord.id,
                            title: meetingRecord.title,
                            meeting_date: meetingRecord.date,
                            meeting_time: meetingRecord.time,
                            venue: meetingRecord.venue,
                            company_attendees: meetingRecord.companyAttendees,
                            client_attendees: meetingRecord.clientAttendees,
                            raw_notes: meetingRecord.rawNotes,
                            summary: meetingRecord.summary,
                            created_at: meetingRecord.createdAt
                        })
                    });

                    console.log('Save response status:', response.status);
                    
                    if (response.ok) {
                        const savedMeeting = await response.json();
                        console.log('Saved meeting:', savedMeeting);
                        return savedMeeting;
                    } else {
                        const errorText = await response.text();
                        console.error('Save error:', response.status, errorText);
                        throw new Error(`HTTP ${response.status}: ${errorText}`);
                    }
                } catch (error) {
                    console.error('Error saving meeting:', error);
                    throw error;
                }
            };

            const deleteMeetingFromDatabase = async (id) => {
                try {
                    console.log('Deleting meeting via API:', id);
                    const response = await fetch(`${API_BASE_URL}/meetings?id=${id}`, {
                        method: 'DELETE',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });

                    console.log('Delete response status:', response.status);
                    
                    if (!response.ok) {
                        const errorText = await response.text();
                        console.error('Delete error:', response.status, errorText);
                        throw new Error(`HTTP ${response.status}: ${errorText}`);
                    }
                } catch (error) {
                    console.error('Error deleting meeting:', error);
                    throw error;
                }
            };

            const deleteMeeting = async (id) => {
                try {
                    await deleteMeetingFromDatabase(id);
                    setStoredMeetings(prev => prev.filter(meeting => meeting.id !== id));
                } catch (error) {
                    console.error('Failed to delete meeting:', error);
                    setSaveError('Failed to delete meeting. Please try again.');
                    setTimeout(() => setSaveError(''), 5000);
                }
            };

            const saveToBrain = async () => {
                if (!summary.trim()) return;
                
                console.log('Starting save to brain...');
                setSaveError('');
                
                const meetingRecord = {
                    id: Date.now(),
                    date: meetingDate || new Date().toISOString().split('T')[0],
                    time: meetingTime || '',
                    venue: location || '',
                    title: meetingTitle || 'Untitled Meeting',
                    companyAttendees: companyAttendees || '',
                    clientAttendees: clientAttendees || '',
                    rawNotes: rawNotes,
                    summary: summary,
                    createdAt: new Date().toISOString()
                };
                
                console.log('Meeting record to save:', meetingRecord);
                
                try {
                    const savedMeeting = await saveMeetingToDatabase(meetingRecord);
                    console.log('Database save successful:', savedMeeting);
                    
                    // Convert database format back to app format for state
                    const appFormatMeeting = {
                        id: savedMeeting.id,
                        date: savedMeeting.meeting_date,
                        time: savedMeeting.meeting_time,
                        venue: savedMeeting.venue,
                        title: savedMeeting.title,
                        companyAttendees: savedMeeting.company_attendees,
                        clientAttendees: savedMeeting.client_attendees,
                        rawNotes: savedMeeting.raw_notes,
                        summary: savedMeeting.summary,
                        createdAt: savedMeeting.created_at
                    };
                    
                    setStoredMeetings(prev => [appFormatMeeting, ...prev]);
                    setShowSaveSuccess(true);
                    setTimeout(() => setShowSaveSuccess(false), 3000);
                } catch (error) {
                    console.error('Failed to save meeting:', error);
                    setSaveError('Failed to save meeting to database. Please try again.');
                    setTimeout(() => setSaveError(''), 5000);
                }
            };

            const handleBrainQuery = async () => {
                if (!brainQuery.trim() || storedMeetings.length === 0) {
                    return;
                }

                setIsBrainLoading(true);
                setBrainResponse('');

                try {
                    // Get fresh data from database for query
                    console.log('Fetching latest meetings for Brain query...');
                    const response = await fetch(`${API_BASE_URL}/meetings`, {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });

                    let meetingsForQuery = storedMeetings;
                    if (response.ok) {
                        const latestMeetings = await response.json();
                        meetingsForQuery = latestMeetings.map(meeting => ({
                            id: meeting.id,
                            date: meeting.meeting_date,
                            time: meeting.meeting_time,
                            venue: meeting.venue,
                            title: meeting.title,
                            companyAttendees: meeting.company_attendees,
                            clientAttendees: meeting.client_attendees,
                            rawNotes: meeting.raw_notes,
                            summary: meeting.summary,
                            createdAt: meeting.created_at
                        }));
                    }

                    const meetingsContext = meetingsForQuery.map(meeting => `
Meeting: ${meeting.title}
Date: ${meeting.date} ${meeting.time}
Venue: ${meeting.venue}
Company Attendees: ${meeting.companyAttendees}
Client Attendees: ${meeting.clientAttendees}
Summary: ${meeting.summary}
---
`).join('\n');

                    // Note: You'll need to replace this with your preferred AI service
                    // For now, this will show a placeholder response
                    const response2 = `Based on the ${meetingsForQuery.length} stored meetings, here's what I found regarding "${brainQuery}":

This is a placeholder response. To enable full AI querying, integrate with your preferred AI service (OpenAI, Anthropic, etc.) by replacing this section with an API call.

Available meetings: ${meetingsForQuery.map(m => m.title).join(', ')}`;
                    
                    setBrainResponse(response2);
                } catch (err) {
                    setBrainResponse('An error occurred whilst processing your query. Please try again.');
                } finally {
                    setIsBrainLoading(false);
                }
            };

            const handleFileUpload = (event) => {
                const uploadedFiles = Array.from(event.target.files);
                setFiles(prev => [...prev, ...uploadedFiles]);
            };

            const removeFile = (index) => {
                setFiles(prev => prev.filter((_, i) => i !== index));
            };

            const extractFromFiles = async () => {
                if (files.length === 0) return;

                setIsGenerating(true);
                
                try {
                    // Simulate file reading and extraction
                    let extractedContent = '';
                    for (const file of files) {
                        const text = await readFile(file);
                        extractedContent += text + '\n\n';
                    }
                    
                    setRawNotes(extractedContent);
                    
                    // Extract meeting details
                    const dateMatch = extractedContent.match(/(?:date|meeting date)[:\s]+(\d{4}-\d{2}-\d{2})/i);
                    const timeMatch = extractedContent.match(/(?:time|meeting time)[:\s]+(\d{1,2}:\d{2})/i);
                    const locationMatch = extractedContent.match(/(?:location|venue|place)[:\s]+([^\n\r]+)/i);
                    const titleMatch = extractedContent.match(/(?:title|subject|meeting)[:\s]+([^\n\r]+)/i);
                    
                    if (dateMatch) setMeetingDate(dateMatch[1]);
                    if (timeMatch) setMeetingTime(timeMatch[1]);
                    if (locationMatch) setLocation(locationMatch[1].trim());
                    if (titleMatch) setMeetingTitle(titleMatch[1].trim());
                    
                } catch (error) {
                    console.error('Error extracting from files:', error);
                } finally {
                    setIsGenerating(false);
                }
            };

            const readFile = (file) => {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = (e) => resolve(e.target.result);
                    reader.onerror = reject;
                    reader.readAsText(file);
                });
            };

            const generateSummary = async () => {
                if (!rawNotes.trim()) return;

                setIsGenerating(true);
                try {
                    // Placeholder summary generation
                    const summary = `# Meeting Summary

## Meeting Overview
This meeting summary has been generated from the uploaded notes. To enable full AI-powered summary generation, integrate with your preferred AI service (OpenAI, Anthropic, etc.).

## Key Points
- Meeting took place on ${meetingDate || 'Date TBD'}
- Location: ${location || 'Location TBD'}
- Attendees included representatives from both companies

## Action Items
- Review and implement discussed points
- Schedule follow-up meeting
- Distribute meeting notes to all stakeholders

## Next Steps
- Continue project development
- Address any outstanding issues
- Maintain regular communication

*Note: This is a template summary. For AI-powered summaries, replace this section with calls to your chosen AI service.*`;

                    setSummary(summary);
                } catch (error) {
                    console.error('Error generating summary:', error);
                } finally {
                    setIsGenerating(false);
                }
            };

            return (
                <div style={{
                    fontFamily: 'system-ui, -apple-system, sans-serif',
                    backgroundColor: '#f8faf6',
                    minHeight: '100vh',
                    padding: '20px'
                }}>
                    <header style={{
                        maxWidth: '1200px',
                        margin: '0 auto',
                        marginBottom: '32px'
                    }}>
                        <div style={{
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'center',
                            marginBottom: '20px'
                        }}>
                            <h1 style={{
                                fontSize: '32px',
                                fontWeight: '700',
                                color: '#374528',
                                margin: '0'
                            }}>
                                Meeting Notes AI Assistant
                            </h1>
                            
                            <button
                                onClick={() => setShowBrain(!showBrain)}
                                style={{
                                    padding: '12px 20px',
                                    borderRadius: '8px',
                                    border: '2px solid #374528',
                                    backgroundColor: showBrain ? '#374528' : 'transparent',
                                    color: showBrain ? 'white' : '#374528',
                                    fontSize: '16px',
                                    fontWeight: '600',
                                    cursor: 'pointer',
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '8px'
                                }}
                            >
                                🧠 Brain ({storedMeetings.length})
                            </button>
                        </div>
                    </header>

                    <main style={{
                        maxWidth: '1200px',
                        margin: '0 auto',
                        display: 'grid',
                        gridTemplateColumns: showBrain ? '1fr 1fr' : '1fr',
                        gap: '32px'
                    }}>
                        {/* Main Content */}
                        <div>
                            {/* Success Messages */}
                            {showSaveSuccess && (
                                <div style={{
                                    backgroundColor: '#d4edda',
                                    border: '1px solid #c3e6cb',
                                    borderRadius: '8px',
                                    padding: '12px',
                                    marginBottom: '20px',
                                    color: '#155724'
                                }}>
                                    ✅ Meeting saved to Brain successfully!
                                </div>
                            )}

                            {saveError && (
                                <div style={{
                                    backgroundColor: '#f8d7da',
                                    border: '1px solid #f5c6cb',
                                    borderRadius: '8px',
                                    padding: '12px',
                                    marginBottom: '20px',
                                    color: '#721c24'
                                }}>
                                    ❌ {saveError}
                                </div>
                            )}

                            {/* File Upload Section */}
                            <section style={{
                                backgroundColor: 'white',
                                borderRadius: '12px',
                                padding: '24px',
                                boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                                marginBottom: '24px'
                            }}>
                                <h2 style={{
                                    fontSize: '20px',
                                    fontWeight: '600',
                                    marginBottom: '16px',
                                    color: '#374528'
                                }}>
                                    📁 Upload Meeting Files
                                </h2>
                                
                                <div className="custom-file-input">
                                    <input
                                        type="file"
                                        multiple
                                        accept=".txt,.docx,.pdf,.md"
                                        onChange={handleFileUpload}
                                        id="file-upload"
                                    />
                                    <label htmlFor="file-upload" style={{
                                        display: 'inline-block',
                                        padding: '12px 24px',
                                        backgroundColor: '#6b7c4e',
                                        color: 'white',
                                        borderRadius: '8px',
                                        cursor: 'pointer',
                                        fontSize: '14px',
                                        fontWeight: '500'
                                    }}>
                                        Choose Files
                                    </label>
                                </div>

                                {files.length > 0 && (
                                    <div style={{ marginTop: '16px' }}>
                                        <h3 style={{
                                            fontSize: '16px',
                                            fontWeight: '500',
                                            marginBottom: '8px',
                                            color: '#374528'
                                        }}>
                                            Uploaded Files:
                                        </h3>
                                        <div>
                                            {files.map((file, index) => (
                                                <div key={index} style={{
                                                    display: 'flex',
                                                    justifyContent: 'space-between',
                                                    alignItems: 'center',
                                                    padding: '8px 12px',
                                                    backgroundColor: '#f8faf6',
                                                    borderRadius: '6px',
                                                    marginBottom: '8px'
                                                }}>
                                                    <span style={{ fontSize: '14px', color: '#374528' }}>
                                                        {file.name}
                                                    </span>
                                                    <button
                                                        onClick={() => removeFile(index)}
                                                        style={{
                                                            background: 'none',
                                                            border: 'none',
                                                            color: '#dc3545',
                                                            cursor: 'pointer',
                                                            fontSize: '16px'
                                                        }}
                                                    >
                                                        ✕
                                                    </button>
                                                </div>
                                            ))}
                                        </div>
                                        <button
                                            onClick={extractFromFiles}
                                            disabled={isGenerating}
                                            style={{
                                                marginTop: '12px',
                                                padding: '10px 20px',
                                                backgroundColor: '#6b7c4e',
                                                color: 'white',
                                                border: 'none',
                                                borderRadius: '6px',
                                                cursor: isGenerating ? 'not-allowed' : 'pointer',
                                                opacity: isGenerating ? 0.6 : 1,
                                                fontSize: '14px',
                                                fontWeight: '500'
                                            }}
                                        >
                                            {isGenerating ? 'Extracting...' : 'Extract Content'}
                                        </button>
                                    </div>
                                )}
                            </section>

                            {/* Meeting Details Section */}
                            <section style={{
                                backgroundColor: 'white',
                                borderRadius: '12px',
                                padding: '24px',
                                boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                                marginBottom: '24px'
                            }}>
                                <h2 style={{
                                    fontSize: '20px',
                                    fontWeight: '600',
                                    marginBottom: '16px',
                                    color: '#374528'
                                }}>
                                    📅 Meeting Details
                                </h2>
                                
                                <div style={{
                                    display: 'grid',
                                    gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))',
                                    gap: '16px'
                                }}>
                                    <div>
                                        <label style={{
                                            display: 'block',
                                            marginBottom: '4px',
                                            fontSize: '14px',
                                            fontWeight: '500',
                                            color: '#374528'
                                        }}>
                                            Meeting Title
                                        </label>
                                        <input
                                            type="text"
                                            value={meetingTitle}
                                            onChange={(e) => setMeetingTitle(e.target.value)}
                                            placeholder="Enter meeting title"
                                            style={{
                                                width: '100%',
                                                padding: '8px 12px',
                                                border: '1px solid #d1d5db',
                                                borderRadius: '6px',
                                                fontSize: '14px'
                                            }}
                                        />
                                    </div>
                                    
                                    <div>
                                        <label style={{
                                            display: 'block',
                                            marginBottom: '4px',
                                            fontSize: '14px',
                                            fontWeight: '500',
                                            color: '#374528'
                                        }}>
                                            Date
                                        </label>
                                        <input
                                            type="date"
                                            value={meetingDate}
                                            onChange={(e) => setMeetingDate(e.target.value)}
                                            style={{
                                                width: '100%',
                                                padding: '8px 12px',
                                                border: '1px solid #d1d5db',
                                                borderRadius: '6px',
                                                fontSize: '14px'
                                            }}
                                        />
                                    </div>
                                    
                                    <div>
                                        <label style={{
                                            display: 'block',
                                            marginBottom: '4px',
                                            fontSize: '14px',
                                            fontWeight: '500',
                                            color: '#374528'
                                        }}>
                                            Time
                                        </label>
                                        <input
                                            type="time"
                                            value={meetingTime}
                                            onChange={(e) => setMeetingTime(e.target.value)}
                                            style={{
                                                width: '100%',
                                                padding: '8px 12px',
                                                border: '1px solid #d1d5db',
                                                borderRadius: '6px',
                                                fontSize: '14px'
                                            }}
                                        />
                                    </div>
                                    
                                    <div>
                                        <label style={{
                                            display: 'block',
                                            marginBottom: '4px',
                                            fontSize: '14px',
                                            fontWeight: '500',
                                            color: '#374528'
                                        }}>
                                            Location/Venue
                                        </label>
                                        <input
                                            type="text"
                                            value={location}
                                            onChange={(e) => setLocation(e.target.value)}
                                            placeholder="Meeting location"
                                            style={{
                                                width: '100%',
                                                padding: '8px 12px',
                                                border: '1px solid #d1d5db',
                                                borderRadius: '6px',
                                                fontSize: '14px'
                                            }}
                                        />
                                    </div>
                                    
                                    <div>
                                        <label style={{
                                            display: 'block',
                                            marginBottom: '4px',
                                            fontSize: '14px',
                                            fontWeight: '500',
                                            color: '#374528'
                                        }}>
                                            Company Attendees
                                        </label>
                                        <input
                                            type="text"
                                            value={companyAttendees}
                                            onChange={(e) => setCompanyAttendees(e.target.value)}
                                            placeholder="Company attendees"
                                            style={{
                                                width: '100%',
                                                padding: '8px 12px',
                                                border: '1px solid #d1d5db',
                                                borderRadius: '6px',
                                                fontSize: '14px'
                                            }}
                                        />
                                    </div>
                                    
                                    <div>
                                        <label style={{
                                            display: 'block',
                                            marginBottom: '4px',
                                            fontSize: '14px',
                                            fontWeight: '500',
                                            color: '#374528'
                                        }}>
                                            Client Attendees
                                        </label>
                                        <input
                                            type="text"
                                            value={clientAttendees}
                                            onChange={(e) => setClientAttendees(e.target.value)}
                                            placeholder="Client attendees"
                                            style={{
                                                width: '100%',
                                                padding: '8px 12px',
                                                border: '1px solid #d1d5db',
                                                borderRadius: '6px',
                                                fontSize: '14px'
                                            }}
                                        />
                                    </div>
                                </div>
                            </section>

                            {/* Raw Notes Section */}
                            <section style={{
                                backgroundColor: 'white',
                                borderRadius: '12px',
                                padding: '24px',
                                boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                                marginBottom: '24px'
                            }}>
                                <h2 style={{
                                    fontSize: '20px',
                                    fontWeight: '600',
                                    marginBottom: '16px',
                                    color: '#374528'
                                }}>
                                    📝 Raw Meeting Notes
                                </h2>
                                <textarea
                                    value={rawNotes}
                                    onChange={(e) => setRawNotes(e.target.value)}
                                    placeholder="Paste or type your meeting notes here..."
                                    style={{
                                        width: '100%',
                                        minHeight: '200px',
                                        padding: '12px',
                                        border: '1px solid #d1d5db',
                                        borderRadius: '8px',
                                        fontSize: '14px',
                                        lineHeight: '1.5',
                                        resize: 'vertical'
                                    }}
                                />
                                <button
                                    onClick={generateSummary}
                                    disabled={!rawNotes.trim() || isGenerating}
                                    style={{
                                        marginTop: '12px',
                                        padding: '12px 24px',
                                        backgroundColor: rawNotes.trim() ? '#6b7c4e' : '#9ca3af',
                                        color: 'white',
                                        border: 'none',
                                        borderRadius: '8px',
                                        cursor: rawNotes.trim() ? 'pointer' : 'not-allowed',
                                        fontSize: '14px',
                                        fontWeight: '500'
                                    }}
                                >
                                    {isGenerating ? '🔄 Generating Summary...' : '✨ Generate Professional Summary'}
                                </button>
                            </section>

                            {/* Summary Section */}
                            {summary && (
                                <section style={{
                                    backgroundColor: 'white',
                                    borderRadius: '12px',
                                    padding: '24px',
                                    boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                                    marginBottom: '24px'
                                }}>
                                    <div style={{
                                        display: 'flex',
                                        justifyContent: 'space-between',
                                        alignItems: 'center',
                                        marginBottom: '16px'
                                    }}>
                                        <h2 style={{
                                            fontSize: '20px',
                                            fontWeight: '600',
                                            color: '#374528',
                                            margin: '0'
                                        }}>
                                            📋 Professional Summary
                                        </h2>
                                        <button
                                            onClick={saveToBrain}
                                            disabled={!summary.trim()}
                                            style={{
                                                padding: '8px 16px',
                                                backgroundColor: summary.trim() ? '#6b7c4e' : '#9ca3af',
                                                color: 'white',
                                                border: 'none',
                                                borderRadius: '6px',
                                                cursor: summary.trim() ? 'pointer' : 'not-allowed',
                                                fontSize: '14px',
                                                fontWeight: '500'
                                            }}
                                        >
                                            🧠 Save to Brain
                                        </button>
                                    </div>
                                    <div style={{
                                        padding: '16px',
                                        backgroundColor: '#f8faf6',
                                        borderRadius: '8px',
                                        border: '1px solid #e5e7eb',
                                       whiteSpace: 'pre-wrap',
                                       fontSize: '14px',
                                       lineHeight: '1.6'
                                   }}>
                                       {summary}
                                   </div>
                               </section>
                           )}
                       </div>

                       {/* Brain Panel */}
                       {showBrain && (
                           <div style={{
                               backgroundColor: 'white',
                               borderRadius: '12px',
                               padding: '24px',
                               boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                               height: 'fit-content'
                           }}>
                               <h2 style={{ 
                                   fontSize: '20px', 
                                   fontWeight: '600', 
                                   marginBottom: '16px',
                                   color: '#374528',
                                   display: 'flex',
                                   alignItems: 'center',
                                   gap: '8px'
                               }}>
                                   🧠 Meeting Brain
                               </h2>

                               {/* Query Section */}
                               <div style={{ marginBottom: '20px' }}>
                                   <label style={{
                                       display: 'block',
                                       marginBottom: '8px',
                                       fontSize: '14px',
                                       fontWeight: '500',
                                       color: '#374528'
                                   }}>
                                       Ask about your meetings:
                                   </label>
                                   <div style={{ display: 'flex', gap: '8px' }}>
                                       <input
                                           type="text"
                                           value={brainQuery}
                                           onChange={(e) => setBrainQuery(e.target.value)}
                                           placeholder="e.g., What action items were assigned to Maria?"
                                           onKeyPress={(e) => e.key === 'Enter' && handleBrainQuery()}
                                           style={{
                                               flex: 1,
                                               padding: '8px 12px',
                                               border: '1px solid #d1d5db',
                                               borderRadius: '6px',
                                               fontSize: '14px'
                                           }}
                                       />
                                       <button
                                           onClick={handleBrainQuery}
                                           disabled={!brainQuery.trim() || storedMeetings.length === 0 || isBrainLoading}
                                           style={{
                                               padding: '8px 16px',
                                               backgroundColor: (brainQuery.trim() && storedMeetings.length > 0) ? '#6b7c4e' : '#9ca3af',
                                               color: 'white',
                                               border: 'none',
                                               borderRadius: '6px',
                                               cursor: (brainQuery.trim() && storedMeetings.length > 0) ? 'pointer' : 'not-allowed',
                                               fontSize: '14px',
                                               fontWeight: '500'
                                           }}
                                       >
                                           {isBrainLoading ? '🔄' : '🔍'}
                                       </button>
                                   </div>
                               </div>

                               {/* Response Section */}
                               {brainResponse && (
                                   <div style={{
                                       padding: '12px',
                                       backgroundColor: '#f8faf6',
                                       borderRadius: '8px',
                                       marginBottom: '20px',
                                       border: '1px solid #e5e7eb'
                                   }}>
                                       <h4 style={{
                                           fontSize: '14px',
                                           fontWeight: '600',
                                           marginBottom: '8px',
                                           color: '#374528'
                                       }}>
                                           Response:
                                       </h4>
                                       <div style={{
                                           fontSize: '14px',
                                           lineHeight: '1.5',
                                           whiteSpace: 'pre-wrap'
                                       }}>
                                           {brainResponse}
                                       </div>
                                   </div>
                               )}

                               {/* Stored Meetings List */}
                               <div>
                                   <h3 style={{
                                       fontSize: '16px',
                                       fontWeight: '600',
                                       marginBottom: '12px',
                                       color: '#374528'
                                   }}>
                                       Stored Meetings ({storedMeetings.length})
                                   </h3>
                                   
                                   {isLoadingMeetings ? (
                                       <div style={{ textAlign: 'center', padding: '20px' }}>
                                           <div>🔄 Loading meetings...</div>
                                       </div>
                                   ) : storedMeetings.length === 0 ? (
                                       <div style={{
                                           textAlign: 'center',
                                           padding: '20px',
                                           color: '#6b7280',
                                           fontSize: '14px'
                                       }}>
                                           No meetings stored yet. Generate and save a summary to get started!
                                       </div>
                                   ) : (
                                       <div style={{ maxHeight: '400px', overflowY: 'auto' }}>
                                           {storedMeetings.map((meeting) => (
                                               <div key={meeting.id} style={{
                                                   padding: '12px',
                                                   backgroundColor: '#f8faf6',
                                                   borderRadius: '8px',
                                                   marginBottom: '8px',
                                                   border: '1px solid #e5e7eb'
                                               }}>
                                                   <div style={{
                                                       display: 'flex',
                                                       justifyContent: 'space-between',
                                                       alignItems: 'flex-start',
                                                       marginBottom: '8px'
                                                   }}>
                                                       <div>
                                                           <h4 style={{
                                                               fontSize: '14px',
                                                               fontWeight: '600',
                                                               margin: '0 0 4px 0',
                                                               color: '#374528'
                                                           }}>
                                                               {meeting.title}
                                                           </h4>
                                                           <div style={{
                                                               fontSize: '12px',
                                                               color: '#6b7280'
                                                           }}>
                                                               📅 {meeting.date} {meeting.time && `at ${meeting.time}`}
                                                               {meeting.venue && ` • 📍 ${meeting.venue}`}
                                                           </div>
                                                       </div>
                                                       <button
                                                           onClick={() => deleteMeeting(meeting.id)}
                                                           style={{
                                                               background: 'none',
                                                               border: 'none',
                                                               color: '#dc3545',
                                                               cursor: 'pointer',
                                                               fontSize: '14px',
                                                               padding: '4px'
                                                           }}
                                                           title="Delete meeting"
                                                       >
                                                           🗑️
                                                       </button>
                                                   </div>
                                                   {(meeting.companyAttendees || meeting.clientAttendees) && (
                                                       <div style={{
                                                           fontSize: '12px',
                                                           color: '#6b7280',
                                                           marginBottom: '8px'
                                                       }}>
                                                           {meeting.companyAttendees && `👥 ${meeting.companyAttendees}`}
                                                           {meeting.companyAttendees && meeting.clientAttendees && ' • '}
                                                           {meeting.clientAttendees && `🤝 ${meeting.clientAttendees}`}
                                                       </div>
                                                   )}
                                                   <div style={{
                                                       fontSize: '12px',
                                                       color: '#374528',
                                                       maxHeight: '60px',
                                                       overflow: 'hidden',
                                                       textOverflow: 'ellipsis'
                                                   }}>
                                                       {meeting.summary.substring(0, 150)}...
                                                   </div>
                                               </div>
                                           ))}
                                       </div>
                                   )}
                               </div>
                           </div>
                       )}
                   </main>
               </div>
           );
       }

       ReactDOM.render(<MeetingNotesApp />, document.getElementById('root'));
   </script>
</body>
</html>
